<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>《计算机网络原理》期末复习 | 等到天亮我们都寻找到最漂亮的愿望</title><meta name="keywords" content="notes"><meta name="author" content="Sheeta Liu"><meta name="copyright" content="Sheeta Liu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="在看完几乎整本书以及PPT后整理下来的知识点">
<meta property="og:type" content="article">
<meta property="og:title" content="《计算机网络原理》期末复习">
<meta property="og:url" content="http://liuydd.github.io/2024/06/17/networks/index.html">
<meta property="og:site_name" content="等到天亮我们都寻找到最漂亮的愿望">
<meta property="og:description" content="在看完几乎整本书以及PPT后整理下来的知识点">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://liuydd.github.io/images/cover39.jpg">
<meta property="article:published_time" content="2024-06-17T09:27:23.000Z">
<meta property="article:modified_time" content="2024-06-18T11:18:52.129Z">
<meta property="article:author" content="Sheeta Liu">
<meta property="article:tag" content="notes">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://liuydd.github.io/images/cover39.jpg"><link rel="shortcut icon" href="../../../../img/tubiao.jpg"><link rel="canonical" href="http://liuydd.github.io/2024/06/17/networks/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="../../../../css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '《计算机网络原理》期末复习',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-06-18 19:18:52'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/c/font_3870185_ugzi44wm6l.css"><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="atom.xml" title="等到天亮我们都寻找到最漂亮的愿望" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="../img/touxiang2.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="../archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="../tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="../index.html"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="../archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="../categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="../link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="../about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('../../../../images/cover39.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="../index.html">等到天亮我们都寻找到最漂亮的愿望</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="../index.html"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="../archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="../categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="../link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="../about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">《计算机网络原理》期末复习</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-06-17T09:27:23.000Z" title="发表于 2024-06-17 17:27:23">2024-06-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-06-18T11:18:52.129Z" title="更新于 2024-06-18 19:18:52">2024-06-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="../../../../categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/">课程笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">18.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>66分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="《计算机网络原理》期末复习"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="ReadMe"><a href="#ReadMe" class="headerlink" title="ReadMe"></a>ReadMe</h2><p><a target="_blank" rel="noopener" href="https://ur2x4vqise.feishu.cn/docx/DkjcdctzRoWz3SxSjAmcDHGcn2b?from=from_copylink">这是我的网原笔记</a></p>
<p>笔记是用飞书做的，下面的内容为直接复制粘贴，也可以直接用飞书链接查看</p>
<p>大部分都做的特别认真，只有第七章4G5G部分有点划水</p>
<p>可供复习参考</p>
<p>今年期末考的点很细<del>（很怪，我怎么记得谁发明了TCP&#x2F;WIFI&#x2F;Ethernet…）</del>，需要将大黑书的部分仔细阅读并牢记后才有可能打高分（好吧，可能是因为我菜，且记忆力已经不太好了</p>
<p>平时可以不去听课，但是有小测<del>（小测说是闭卷，其实大多数同学都会Ctrl F PPT，并且只要不被老师发现可以直接抄同学的&#x2F;对答案）</del>，小测题目在后期就不可见了，建议做完一次小测就将题目和答案保存下来，期末可能会涉及到（今年期末貌似第一道选择题就是小测的原题）</p>
<p>除了期末闭卷题目奇怪要背诵外，平时的任务量接近于零，四次作业（似乎只要做了就是100分？反正我自己是这样的），每章结束后会有雨课堂小测，全是单选题。</p>
<h1 id="1-Computer-Networks-and-the-Internet"><a href="#1-Computer-Networks-and-the-Internet" class="headerlink" title="1 Computer Networks and the Internet"></a>1 Computer Networks and the Internet</h1><h2 id="1-1-What-is-the-Internet"><a href="#1-1-What-is-the-Internet" class="headerlink" title="1.1 What is the Internet?"></a>1.1 What is the Internet?</h2><p>描述方式一：通过硬件和软件组件</p>
<ol>
<li>接入互联网的设备为主机host(端系统end system)，end system通过通信链路comunication link和分组交换机packet switch连接到一起</li>
<li>Packet switch类型有路由route和链路层交换机link-layer switch，它们都要向最终目的地发送分组。link-layer switch通常用于接入网中，而route通常用于网络核心中</li>
<li>ISP：Internet Service Provider，端系统通过ISP接入因特网，每个ISP自身就是一个由多台分组交换机和多段通信链路组成的网络。ISP互联，较低层的ISP通过国家国际的较高层ISP互联，较高层ISP彼此直接互联。</li>
<li>协议protocols控制信息的发送与接收</li>
<li>Internet standards: 由因特网工程任务组IETF(Internet Engineering Task Force)研发，IETF的标准文档称为请求评论RFC(Request For Comment)，RFC文档定义了TCP&#x2F;IP&#x2F;HTTP&#x2F;SMTP等协议</li>
</ol>
<p>描述方式二：根据基础设施向分布式应用提供的服务</p>
<ol>
<li>Infrastructure provides service to applications</li>
<li>Provides programming interface to distributed applications</li>
</ol>
<p>协议protocol</p>
<p>协议定义了在两个或多个通信实体之间交换的报文的<strong>格式和顺序format and order</strong>，以及报文的发送&#x2F;接收或其他事件所采取的<strong>操作action</strong></p>
<h2 id="1-2-Network-edge网络边缘"><a href="#1-2-Network-edge网络边缘" class="headerlink" title="1.2 Network edge网络边缘"></a>1.2 Network edge网络边缘</h2><ol>
<li>Internet structure:</li>
</ol>
<ul>
<li>Network edge: host(host可进一步划分为客户client和服务器server，服务器server通常属于大型数据中心data center)</li>
<li>Access networks, physical media(接入网，将端系统物理连接到其边缘路由器的网络): communication links</li>
<li>Network core: routers, network of networks (ISPs)</li>
</ul>
<ol>
<li>How to connect end systems to edge router?</li>
</ol>
<ul>
<li>Residential access nets(家庭接入：DSL\电缆、FTTH和5G固定式无线)</li>
<li>Institutional access networks(企业接入school, company)</li>
<li>Mobile access networks(广域无线接入WIFI, 4G&#x2F;5G)</li>
</ul>
<p>Residential access nets家庭接入</p>
<p>数字用户线(DSL，Digital Subscriber Line)和电缆网络(cable Internrt access)</p>
<p>数字用户线DSL：use <em>existing</em> telephone line to central office DSLAM（data over DSL phone line goes to Internet，voice over DSL phone line goes to telephone net）</p>
<p>电缆网络：由于系统中既应用了光纤也应用了同轴电缆，故常被称为混合光纤同轴(Hybrid Fiber Coax, HFC)；共享广播媒体（多用户同时下载时接收速率远低于电缆总计的下行速率，且由于上行信道也是共享的，需要一个分布式多路访问协议来协调传输和避免碰撞）</p>
<p>光纤到户(Fiber To The Home, FTTH)</p>
<p>Institutional access networks企业接入</p>
<p>mix of wired, wireless link technologies, connecting a mix of switches and routers</p>
<p>Ethernet: wired access at 100Mbps, 1Gbps, 10Gbps</p>
<p>WiFi: wireless access points at 11, 54, 450 Mbps</p>
<ol>
<li>Links物理媒介</li>
</ol>
<h2 id="1-3-Network-core网络核心"><a href="#1-3-Network-core网络核心" class="headerlink" title="1.3 Network core网络核心"></a>1.3 Network core网络核心</h2><ol>
<li>packet-switching分组交换: hosts break application-layer messages into packets</li>
</ol>
<p>存储转发传输Store-and-forward transmission：交换机必须确保接收到整个分组后才能开始向输出链路传输该分组的第一个比特，所以就会存在时延，总时延是2L&#x2F;R（若没有这个机制，则总时延是L&#x2F;R）。一般情况，通过由N条速率均为R的链路组成的路径，从源到目的地发送一个分组，此时端到端时延为NL&#x2F;R</p>
<p>排队时延和分组丢失queuing and loss：①queuing：分组到达的速率大于被处理的速率，分组要承受输出缓存的排队时延queuing delay；②loss：由于缓存空间有限，当一个到达的分组发现缓存被其他等待传输的分组完全充满的时候，到达的分组或已经排队的分组之一将被丢弃</p>
<p>转发表和路由选择协议：当源主机要向目的端系统发送一个分组时，源在该分组的首部中包含了目的地的IP地址。每台路由器都具有一个转发表（forwarding table）</p>
<ol>
<li>Circuit switching电路交换</li>
</ol>
<p>会预留资源（缓存、链路传输速率），每个端到端电路交换会均分传输速率</p>
<p>通过频分复用(Frequency-Division Multiplexing, FDM)或时分复用(Time-Division Multiplexing, TDM)来实现的</p>
<ol>
<li>Packet switching vs Circuit switching</li>
</ol>
<p>Packet switching is great for bursty data(激增的数据)，会有时延和包丢失</p>
<p>Circuit switching 会保留资源，但是某种程度上也会造成资源的浪费，且每条电路的传输速率会降低</p>
<p>趋势是朝着分组交换方向发展</p>
<ol>
<li>Internet structure：</li>
</ol>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=YmY4MTcyY2VjYTA5M2YzNTM5Y2Q5ZTRmZGZiMzg4YzdfV0ZVck1oTnRNZ2ZYU0VLMEQ0R3RzWkZTOWlycmEyWVBfVG9rZW46SkFPWWI0NFRJbzJWaXh4eUJkNmNNVjBCbm9ZXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<h2 id="1-4-Performance-loss丢包-delay时延-throughput吞吐量"><a href="#1-4-Performance-loss丢包-delay时延-throughput吞吐量" class="headerlink" title="1.4 Performance: loss丢包, delay时延, throughput吞吐量"></a>1.4 Performance: loss丢包, delay时延, throughput吞吐量</h2><ol>
<li>四种时延</li>
</ol>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=OWJkMjQyOGUwNGU3YTZiY2IwYmNhOTdiYTlmZDc4NWFfbU9MandyUmptRFJzdG5DbzcyNmh3RXcxenVQNnl5YlNfVG9rZW46RHpueWI2YjlOb2lLY3p4ZWFUbmNYUmxwbndlXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ul>
<li>节点处理时延nodal processing delay<ul>
<li>检查分组首部</li>
<li>决定将该分组导向何处determine output link</li>
<li>检查比特级别的差错check bit errors</li>
</ul>
</li>
<li>排队时延queuing delay<ul>
<li>time waiting at output link for transmission</li>
<li>取决于路由的拥塞情况(congestion level)</li>
</ul>
</li>
<li>传输时延transmission delay<ul>
<li>仅当所有已经到达的分组被传输后，才能传输刚到达的分组</li>
<li>若L为分组长度，R为链路传输速率，则传输时延为L&#x2F;R。这是将一个比特推向链路所需要的时间（类比发射</li>
</ul>
</li>
<li>传播时延propagation delay<ul>
<li>一旦一个比特被推向链路，该比特需要向路由器B传播，从该链路的起点到路由器B传播所需要的时间就是传播时延</li>
<li>若d是路由器A和B之间的距离，S，是该链路的传播速率，则传播时延为d&#x2F;s</li>
</ul>
</li>
</ul>
<ol>
<li>排队时延与丢包</li>
</ol>
<p>流量强度traffic intensity：La&#x2F;R</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZDQwODlkYTQ1N2RhNWEwNTkwODIxYTEwOWVkZmUyZDdfTGZDN1hZYTlVUlJESkdjamdtbWcxdnIzOVU1aUtUdkpfVG9rZW46QU1aOWJwN3Rmb3VSaUp4b2JaOGM4TWY4bkliXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>考虑所有的时延（除排队时延外，因为其可以不计），端到端时延等于N(d_proc + d_trans + d_prop)，其中d_trans &#x3D; L&#x2F;R</p>
<ol>
<li>吞吐量（以bps计）<ol>
<li><p>瞬间吞吐量instantaneous throughput：主机B接收到该文件的速率</p>
</li>
<li><p>平均吞吐量average throughput：若主机接收到所有F bit用了T s，则平均吞吐量为F&#x2F;T bps</p>
</li>
<li><p>瓶颈链路：</p>
</li>
<li><p>服务器–(Rs)–路由器–(Rc)–客户，则吞吐量取Rs和Rc之间的更小者，故从服务器向客户传输一个F bit的大文件所需要的时间是F&#x2F;min{Rs, Rc}</p>
</li>
<li><p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MmJjZmZjNTg4Mzg4MDhlOWQ2MTA4MGNiOGQ1ODExN2FfbWxsWW1OVTl6cVU0YTlGY2llNzhQclZaMDJFVU80RnZfVG9rZW46WjJSZmIwbGxsbzlWUXV4TW9veWNOOE5UbjNlXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
</li>
</ol>
</li>
</ol>
<h2 id="1-5-Protocol-layers-service-models协议层次及其服务模型"><a href="#1-5-Protocol-layers-service-models协议层次及其服务模型" class="headerlink" title="1.5 Protocol layers, service models协议层次及其服务模型"></a>1.5 Protocol layers, service models协议层次及其服务模型</h2><p>Layered Internet protocol stack：</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=YTAzZTU2MmU2ZTQxODQzYTI5M2ViZWZhZjM1NjM2ZTVfcGN0ZDBRSnlkSDNUZ01WeGZoZ1hUbHpEWUVFaXNzb3VfVG9rZW46TkZQMGJXNzIyb0NjQVB4Q0NmYmNNQWJIbmhiXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<h2 id="1-6-Security"><a href="#1-6-Security" class="headerlink" title="1.6 Security"></a>1.6 Security</h2><ul>
<li>经因特网将有害程序放入计算机<ul>
<li>恶意软件malware，且会自我复制self-replicating（从被感染的主机寻求进入因特网上的其他主机）</li>
</ul>
</li>
<li>DoS（拒绝服务攻击，Denial-of-Service attack）：<ul>
<li><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZDM5YzFmZDNhY2FlMGMyMjY0YWMzYmVlYjQ0NmZlNDlfbDE4RjdTajl0SVd6Q2pQRnNHR3dQU2hieTJveHBlSnpfVG9rZW46TmhPY2JuQlRyb3lGM3V4Tm52SGNNYmx4blVkXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></li>
</ul>
</li>
<li>嗅探分组packet sniffing：在无线传输设备的附近放置一台被动的接收机，该接收机能得到传输的每个分组的副本，包含各种敏感信息</li>
<li>IP哄骗 IP spoofing：injection注入 of packet with false source address</li>
</ul>
<p>防御方式：</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZDk1Njc2MTk4M2VjNmUyZmJiYjIxZWQ1MDllYmNlMDRfQjZZSW4xdklMMkFxRjQ3SkZwR0dwOXJYVktpRGVjNVVfVG9rZW46WTZ6VGJHRW9MbzFVTzZ4bkVhUmM3MDVpbk5jXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<h1 id="2-The-Application-Layer"><a href="#2-The-Application-Layer" class="headerlink" title="2 The Application Layer"></a>2 The Application Layer</h1><h2 id="2-1-Principles-of-network-applications"><a href="#2-1-Principles-of-network-applications" class="headerlink" title="2.1 Principles of network applications"></a>2.1 Principles of network applications</h2><ol>
<li>When creating a network app：需要编写将在多个端系统上运行的软件，不需要写在网络核心设备如路由器和链路层交换机上运行的软件。网络核心设备不作用于应用层而是作用于较低的层次，特别是在网络层及其以下，这种基本的设计就是让应用软件与终端系统隔离。</li>
<li>应用体系结构application architecture</li>
</ol>
<ul>
<li>Client-server architecture<ul>
<li><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZmViMjdkYzMxMWMwMzM5NjUxNjcyZjI4YzBlOTIzNzVfTHpwZUwya2VtZFRKdXRuanF0MzREMTRnZEFRcU5GcXVfVG9rZW46RnU3S2JQa21qb0tZeE94NmVkOWNobFZ3bkhmXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></li>
</ul>
</li>
<li>P2P architecture<ul>
<li><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NTE4YTQ2OWVkZGFlM2E3MDg4ODBiZDVhZjU2MjNiOGFfMGlubU10QlNTRDFrdXJlS2dZdk0xMmdSSWplWVZPRlhfVG9rZW46UnZNN2JWdlJjb3RtZUZ4TWNwZWNRZ2I3bmpGXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></li>
</ul>
</li>
</ul>
<ol>
<li>Processes communicating进程通信<ol>
<li><p>①客户与服务器进程</p>
</li>
<li><p>当多个进程运行在相同的端系统上时，它们使用<strong>进程间通信机制</strong>相互通信</p>
</li>
<li><p>在两个不同端系统上的进程，通过<strong>跨越计算机网络交换报文（message）</strong></p>
</li>
<li><p>client客户：发起通信（即在该会话开始时发起与其他进程的联系）的进程</p>
</li>
<li><p>server服务器：在会话开始后等待被联系的进程</p>
</li>
<li><p>在P2P文件共享的某些应用中，一个进程能够既是客户又是服务器，但是仍然按照上述划分要求划分</p>
</li>
</ol>
</li>
</ol>
<p>②进程与计算机网络之间的接口：Sockets</p>
<p>网络应用程序由成对的进程组成，这些进程通过网络相互发送报文</p>
<p>socket是同一台主机内应用层与运输层之间的接口</p>
<p>进程可类比于房子，socket类比于它的门</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NmU3MTJiYzc5NTRmNWZiMmZkYTMxYzQ2NGY3NGZiNzVfVEdNSWZaNkRUNnVuQTlsQkZWSXRLV0JDY21raExERHpfVG9rZW46U3FQRWJ4Wm9Vb01yNmR4SnNXS2M3M0VHbkhEXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>③Addressing processes进程寻址</p>
<p>利用IP地址标识主机</p>
<p>标识符包括与主机上的进程关联的<strong>IP地址</strong>和端口号<strong>port number</strong>。有了这两个数据就可以给服务器进程发送报文了</p>
<ol>
<li>The transport service an app need</li>
</ol>
<p>可从四个方面对应用程序服务要求进行分类：</p>
<ul>
<li>可靠数据传输reliable data transfer</li>
<li>吞吐量throughput<ul>
<li>带宽敏感的应用bandwidth-sensitive application：具有吞吐量要求的应用程序</li>
<li>弹性应用elastic application：能根据当时可用的带宽利用可供使用的吞吐量</li>
</ul>
</li>
<li>定时timing<ul>
<li>用于实时交互式应用</li>
</ul>
</li>
<li>安全性security</li>
</ul>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=Yzg0YmY3Mjc0NTlhNjIyMWE1ZmFiNmJjYmM3MzgzZTFfbjRlQkVDbjR3ZlhEMDVhWDR4M1NKM29OYlpUbHU2MzlfVG9rZW46RktsOGJYTlZrb0l3T1F4cERCMWN1TXdMbklkXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>因特网提供的运输服务：</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MTQwZGU5YmU1YjM2NGUwZWQ3NTcxZDBkMTg5MDEwNGVfd3M1ZDZ3VzJDSXhqb0dyTWVNUFE3c3hkWGtGZ1dlUklfVG9rZW46QnlqbGJGUUlxb1k3Szd4WHVnSmNaUzJRbnlmXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>TCP具有拥塞控制机制而UDP不具备；TCP能无差错、按适当顺序交付所有发送的数据，而UDP不保证该报文将到达接收进程，且到达的报文可能是乱序到达的</p>
<p>TCP安全：无论是TCP还是UDP都没有提供任何加密机制——&gt;使用一种加强版本的TCP，TLS（运输层安全Transport Layer Security）。当一个应用使用TLS时，发送进程向TLS socket传递铭文数据，发送主机中的TLS则加密该数据，并将加密的数据传递给TCP socket，加密的数据经因特网传送到接收进程中的TCP socket，该socket将加密数据传递给TLS，由其进行解密。</p>
<ol>
<li>应用层协议an application-layer protocol</li>
</ol>
<p>一个应用层协议定义了应用的进程是怎么在不同的终端系统运行并彼此发送报文的，特别的，应用层协议定义了： </p>
<ul>
<li>Types of messages exchanged交换的报文的类型，举例，请求报文和响应报文 </li>
<li>Message syntax不同的报文类型的语法，比如报文中的各个字段及这些字段是如何描述的 </li>
<li>Message semantics报文中各个字段的语义，就是这些字段中信息的含义 </li>
<li>Rules确定一个进程何时以及如何发送报文，对报文进行响应的规则</li>
</ul>
<p>Open protocols：有些应用层协议是由RFC文档定义的，因此它们位于公共域中，everyone has access to protocol definition。如HTTP, SMTP</p>
<p>Proprietary protocols：如Skype, Zoom</p>
<h2 id="2-2-Web-and-HTTP"><a href="#2-2-Web-and-HTTP" class="headerlink" title="2.2 Web and HTTP"></a>2.2 Web and HTTP</h2><ol>
<li>HTTP（超文本传输协议HyperText Transfer Protocol）<ol>
<li><p>①概述：</p>
</li>
<li><p>HTTP是Web的应用层协议，由两个程序实现，一个client程序和一个server程序</p>
</li>
<li><p>HTTP使用TCP</p>
</li>
<li><p>HTTP is stateless（无状态协议）：因为HTTP服务器不会保留clients的任何信息，所以如果我们连续请求两次 同一个对象，它就会回复两次</p>
</li>
</ol>
</li>
</ol>
<p>②HTTP两种类型的连接方式：(HTTP默认使用持续连接)</p>
<ul>
<li>非持续连接non-persistent connection：为每对client-server建立单独的TCP连接<ul>
<li>一个web页面上可能有多个object，而多个object的下载需要多个连接（因为一个html文件上的object实际上是引用，所以要额外下载）</li>
<li>每个TCP连接只传输一个请求报文和一个响应报文，每个TCP连接在服务器发送一个对象后关闭，即该连接并不为其他的对象而持续下来</li>
<li>RTT(往返时间，Round-Trip Time)：一个数据包从client到server然后再返回的时间，RTT包括了中间路由和交换机处的传输延迟和排队延迟，还有处理延迟<ul>
<li>HTTP response time(per object)：每个object都将会有两个RTT的延迟——一个建立TCP连接，一个请求和回复</li>
<li>故<em>Non-persistent HTTP response time &#x3D; 2RTT+ file transmission time</em></li>
<li><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MDlkNWUzZDk0ZjcwZjI1MDhhODA2ZmU5MThmNDAzMmJfYTRpb2x3VWs2TjZnWmVEbzJYRTBXSzVFcWZGSlBvMFhfVG9rZW46T0IxRmJpUkM4b2QxYVV4cmJQNGNFMFkwbjVHXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></li>
</ul>
</li>
</ul>
</li>
<li>持续连接persistent connection：使用同一个TCP连接<ul>
<li>client sends requests as soon as it encounters a referenced object（而不必等待对未决请求的回答）</li>
<li>as little as one RTT for all the referenced objects (cutting response time in half)</li>
</ul>
</li>
</ul>
<p>③HTTP报文格式</p>
<ul>
<li>请求报文<ul>
<li>请求行request line：方法字段、URL字段和HTTP版本字段</li>
<li>首部行header line：<ul>
<li>Host</li>
<li>Connection: close</li>
<li>User-agent</li>
<li>Accept-language</li>
</ul>
</li>
</ul>
</li>
<li>响应报文<ul>
<li>初始状态行status line：协议版本字段、状态码和相应状态信息</li>
<li>首部行header line</li>
<li>实体体entity body</li>
</ul>
</li>
</ul>
<ol>
<li>Cookie：用户与服务器的交互</li>
</ol>
<p>四个组件：</p>
<ol>
<li><p>cookie header line of HTTP <em>response</em> message </p>
</li>
<li><p>cookie header line in next HTTP <em>request</em> message </p>
</li>
<li><p>cookie file kept on user ’ s host, managed by user ’ s browser </p>
</li>
<li><p>back-end database at Web site</p>
</li>
<li><p>Web caches缓存（也叫代理服务器proxy server）</p>
</li>
</ol>
<p>Web caches既是server又是client，server for original requesting client；client to origin server</p>
<p>好处：</p>
<ul>
<li>reduce response time for client request</li>
<li>reduce traffic on an institution’s access link</li>
<li>Internet is dense with caches，enables “poor” content providers to more effectively deliver content</li>
</ul>
<p>Conditional GET：允许缓存器证实它的对象是最新的</p>
<ul>
<li>方法：在请求报文中包含一个“If-modified-since: ”首部行，首部行的值等于之前服务器发送的响应报文中的“Last-Modified: ”</li>
<li>作为条件GET方法的响应，该Web服务器仍会发送一个响应报文，但并没有在该响应报文中包含所请求的对象，为了避免浪费带宽</li>
</ul>
<ol>
<li>HTTP&#x2F;2<ol>
<li><p>主要目标是减小感知时延</p>
</li>
<li><p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=YjBhMGRlZGYwOGM2NDE0MTA5OTc2ZGE5YzNhN2Y0YmJfNXVNMWhiMDVWb1I2azFXTU5lUlg2OWJkNmRkZkpmMzlfVG9rZW46TVFvT2JLZ1kxbzd1bld4ckRxT2Njdm9nbm1oXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
</li>
</ol>
</li>
</ol>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MGVkOTJkYjdhOGY1NTAyNWE0MDRmM2E3MmFmZjhjNzRfM0dTb3N0c3VPM3dnaFR1VnFrUXpUQ3cxb3lLUkRmdmxfVG9rZW46TkZaNmIwUTV0b253UnF4VDNjVmM3aFpsbnpSXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>队首阻塞Head Of Line(HOL) blocking：经单一TCP连接发送一个Web页面中的所有对象存在队首阻塞问题</p>
<p>HTTP&#x2F;2解决HOL阻塞的方案是将每个报文分成小帧，并且在相同TCP连接上交错发送请求和响应报文</p>
<p>——&gt;HTTP&#x2F;2的重要改进：</p>
<ul>
<li>将一个HTTP报文分成独立的帧、交错发送它们并在接收端将其装配起来</li>
<li>允许服务器为一个客户请求而发送多个响应。即除了对初始请求的响应外，服务器能够向该客户推额外的对象，而无需客户再进行任何请求</li>
</ul>
<p>HTTP&#x2F;3: <strong>adds security</strong>, per object error- and congestion-control (more pipelining) <strong>over UDP</strong></p>
<h2 id="2-3-E-mail-SMTP-IMAP"><a href="#2-3-E-mail-SMTP-IMAP" class="headerlink" title="2.3 E-mail, SMTP, IMAP"></a>2.3 E-mail, SMTP, IMAP</h2><ol>
<li>E-mail：三个主要组成部分<ol>
<li>User agents用户代理</li>
<li>Mail servers邮件服务器</li>
<li>SMTP简单邮件传输协议</li>
</ol>
</li>
</ol>
<p>一个简单的邮件发送过程：从发送方的用户代理开始，传输到发送方的邮件服务器，再传输到接收方的邮件服务器，然后在这里被分发到接收方的邮箱中</p>
<ol>
<li>SMTP：<ol>
<li>SMTP是 Internet email最重要的应用程协议，它使用的是TCP协议在mail server间进行传输</li>
<li>client side运行于发送方mail server，server side运行于接收方mail server，也就是每个mail server都会同时运行client side和server side的SMTP</li>
<li>Three phases of transfer:<ul>
<li>SMTP handshaking(greeting)</li>
<li>SMTP transfer of messages</li>
<li>SMTP closure</li>
</ul>
</li>
<li>发送方和接收方直接是直接传递，无论距离，都是直接连接两个服务器</li>
<li>SMTP和HTTP的比较：<ul>
<li>使用SMTP传送邮件前要将二进制多媒体数据编码为ASCII码，传输后还要解码。而用HTTP传输前不需要将多媒体数据编码为ASCII码</li>
<li><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=Y2U2YWQ0NjY5MzdkNGQ3NzdkNzdjOWE2NWFiNmQ0NjlfaU9GMmJWZWJHdm9ETzd3YjUybHlnQmNWNFRFZ3dwbllfVG9rZW46T3FCdWJQaFNsb0dzNjV4TXRoa2NOVjE0bmVCXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></li>
</ul>
</li>
</ol>
</li>
<li>邮件报文格式</li>
</ol>
<ul>
<li>Header lines<ul>
<li>To: (必含）</li>
<li>From: （必含）</li>
<li>Subject: （可能含）</li>
</ul>
</li>
<li>Blank line</li>
<li>Body</li>
</ul>
<ol>
<li>邮件访问协议mail access protocol</li>
</ol>
<p>接收邮件方的用户代理不能使用SMTP得到报文，因为取报文是一个拉操作，而SMTP是一个推协议。此时有两种方式，若接收方使用的是基于Web的电子邮件或智能手机上的客户端（如Gamil），则用户代理通过HTTP来取邮件；另一种方式是使用IMAP（因特网邮件访问协议）</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=YmM4ZTg3ZTI4YTJlZjJjZGY2MzYzMzA5NmE0MmExMDFfNWVXYXFDcDcyTlc4S20xeHE1bXNmcWtCNXlpeWJwNG1fVG9rZW46VTZIdWJCZ3BEb1dQSm54OVFsbGNydWI5blc2XzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<h2 id="2-4-The-Domain-Name-System-DNS"><a href="#2-4-The-Domain-Name-System-DNS" class="headerlink" title="2.4 The Domain Name System DNS"></a>2.4 The Domain Name System DNS</h2><ol>
<li>DNS：域名系统，实现主机名到IP地址转换的目录服务<ol>
<li><p>DNS是：</p>
</li>
<li><p>一个由分层的DNS服务器实现的<strong>分布式数据库</strong>distributed database</p>
</li>
<li><p>一个使得主机能够查询分布式数据库的<strong>应用层协议</strong></p>
</li>
</ol>
</li>
</ol>
<p>DNS协议运行在<strong>UDP</strong>之上，使用53号端口</p>
<p>DNS通常是由其他应用层协议所使用的，包括HTTP和SMTP，将用户提供的主机名转换为其背后的IP地址</p>
<p>DNS也是通过client-server模式</p>
<ol>
<li>DNS服务：<ol>
<li>Hostname-to-IP-address translation主机名到IP地址的转换</li>
<li>Host aliasing主机别名：区别规范主机名canonical hostname</li>
<li>Mail server aliasing邮件服务器别名</li>
<li>Load distribution负载分配：因为某个站点可能分布在多台服务器上，具有不同的IP地址，当client对映射到某地址集合的名字发出一个DNS请求时，该服务器用IP地址的整个集合进行响应，但在每个回答中循环这些地址次序</li>
</ol>
</li>
<li>DNS工作机理<ol>
<li><p>①Why not centralize DNS?</p>
</li>
<li><p>单点故障sigle point of failure</p>
</li>
<li><p>通信容量traffic volume</p>
</li>
<li><p>远距离的集中式数据库distant centralized database</p>
</li>
<li><p>维护maintenance</p>
</li>
</ol>
</li>
</ol>
<p>——&gt;分布式、层次数据库a distributed, hierarchical database</p>
<p>②三种DNS服务器以及结构：</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZmI4YmM5NWY0MzBlYjA1NjY2ZmFjYzIxZTMwZjZlOWRfSk1ocW4wZzJPbnFGNlpaenNsVXZGeXlHTGZ5eVdhUXRfVG9rZW46TDJiTWJldFI4b293Qnp4bFI3eGNnSlFzblZlXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>③本地DNS服务器local DNS server：</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=OTYyZjdlNjI3YTVhMzE0ZTdhZGNhOTE3OTYzODUxNTVfTVcyNkNKeTFTZWo3UmVicWlweGpJN1NYQmt3bEwwanZfVG9rZW46WUk1QmJKYjRib1M5bjB4VTVocGNiSHpablFjXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>④DNS name resolution名称解析：从请求主机到本地DNS服务器的查询是递归的，其余的查询是迭代的</p>
<ul>
<li>Iterated query</li>
<li>Recursive query</li>
</ul>
<p>⑤DNS缓存：</p>
<ul>
<li>cache entries timeout (disappear) after some time (TTL)</li>
<li>cached entries may be out-of-date</li>
<li>除少数DNS查询以外，根服务器被绕过了</li>
</ul>
<ol>
<li>DNS记录和报文</li>
</ol>
<p>①共同实现DNS分布式数据库的所有DNS服务器储存了资源记录（Resource Record, RR），RR提供了主机名到IP地址的映射</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZDgwM2U0YmYxZjcyMGNjZmNlZmIwOWQyMTY2YWE2MWRfbUUyTUlhQUgyYjZ2M0pTT1pYbmpMU29UaEtVRk5wYWlfVG9rZW46WEV3QmJyWWdZb2NrSmp4dDJJa2NTUUFCbkplXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>②DNS query and reply messages both have the same format</p>
<p>TODO</p>
<ol>
<li>DNS Security</li>
</ol>
<ul>
<li>DDoS attack：由于根服务器可以绕过，所以针对TLD服务器的DDoS攻击更有效</li>
<li>Spoofing attack欺骗伪造：intercept DNS queries, returning bogus replies</li>
</ul>
<h2 id="2-5-P2P-applications"><a href="#2-5-P2P-applications" class="headerlink" title="2.5 P2P applications"></a>2.5 P2P applications</h2><ol>
<li>文件分发时间：<ol>
<li>client-server：（分发时间呈线性增长）<ul>
<li>服务器必须向N个对等方的每个传输该文件的一个副本  NF&#x2F;u_s</li>
<li>每个client必须下载文件副本  F&#x2F;d_min</li>
</ul>
</li>
<li>P2P：（分发时间有上界）<ul>
<li>每个对等方都能够帮服务器分发该文件。当一个对等方接收到某些文件数据，它能够使用自己的上载能力重新将数据分发给其他对等方</li>
<li>在分发的开始，只有服务器具有文件  F&#x2F;u_s</li>
<li>具有最低下载速率的对等方不能以小于F&#x2F;d_min的分发时间获得所有F bit  F&#x2F;d_min</li>
<li>系统整体的总上载能力等于服务器的上载速率加上每个单独的对等方的上载速率 NF&#x2F;(u_s + u1+ … + u_N)</li>
</ul>
</li>
</ol>
</li>
<li>BitTorrent：一种用于文件分发的流行P2P协议<ol>
<li>torrent：参与一个特定文件分发的所有对等方的集合</li>
<li>chunk：在一个torrent中的对等方彼此下载等长度的文件块</li>
<li>tracker追踪器：当一个对等方加入某torrent时，它向追踪器注册自己，并周期性地通知追踪器它仍在该torrent中</li>
<li>Requesting chunks：最稀缺优先rarest first</li>
<li>Sending chunks：tit-for-tat一报还一报<ul>
<li>每过30秒A将随机地选择一名新的对换伴侣并开始与那位伴侣进行对换。如果这两名对等方都满足此对换，它们将对方放入其前4位列表中并继续与对方进行对换，直到该对等方之一发现了一个更好的伴侣为止</li>
</ul>
</li>
</ol>
</li>
</ol>
<h2 id="2-6-video-streaming-and-content-distribution-networks"><a href="#2-6-video-streaming-and-content-distribution-networks" class="headerlink" title="2.6 video streaming and content distribution networks"></a>2.6 video streaming and content distribution networks</h2><ol>
<li>HTTP流和DASH<ol>
<li>HTTP流：<ul>
<li>视频只是储存在HTTP服务器中作为一个普通的文件，每个文件有个特定的URL，当用户要看该视频时，客户与服务器创建一个TCP连接并发送对该URL的HTTP GET请求</li>
<li>缺陷：对不同客户，或者对相同客户的不同时间而言，客户可用的带宽大小有很大不同</li>
</ul>
</li>
<li>DASH（经HTTP的动态适应性流， Dynamic Adaptive Streaming over HTTP）<ul>
<li><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MzgzMmJhOTY3MjU4YmU3YzFiMTJmNWFmYTBjMDI5MDdfSXhSNk5sckNCeUhRaUVJanNXUWtUYTlNTml5bHQwNmZfVG9rZW46STJjNWJ3bEVDb1N5RHh4MldXYWNDUU5zblVoXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></li>
</ul>
</li>
</ol>
</li>
<li>Content distribution networks(CDN)内容分发网</li>
</ol>
<p>to stream content (selected from millions of videos) to hundreds of thousands of simultaneous users</p>
<p>CDN通常采用两种不同的服务器安置原则：</p>
<ul>
<li>深入enter deep：在遍及全球的接入ISP中部署服务器集群来深入到ISP的接入网中，目标是靠近端用户</li>
<li>邀请做客bring home：通过在少量的关键位置建造大集群来邀请到ISP做客。不是将集群放在接入ISP中，这些CDN通常将它们的集群放置在因特网交换点IXP</li>
</ul>
<p>大多数CDN利用DNS来截获和重定向请求</p>
<p>任何CDN部署，其核心是集群选择策略cluster selection strategy，即动态地将客户定向到CDN中的某个服务器集群或数据中心的机制</p>
<h1 id="3-The-Transport-Layer"><a href="#3-The-Transport-Layer" class="headerlink" title="3 The Transport Layer"></a>3 The Transport Layer</h1><h2 id="3-1-Transport-layer-services"><a href="#3-1-Transport-layer-services" class="headerlink" title="3.1 Transport-layer services"></a>3.1 Transport-layer services</h2><ol>
<li>运输层协议是在端系统中而不是在路由器中实现的，即端系统中有应用层、运输层、网络层、链路层和物理层，而路由器中只有网络层、链路层和物理层</li>
<li>Transport protocols actions in end systems:<ol>
<li>Sender: breaks application messages into segments, passes to network layer</li>
<li>Receiver: reassembles segments into messages, passes to application layer</li>
</ol>
</li>
<li>运输层 vs 网络层<ol>
<li>运输层： communication between processes</li>
<li>网络层：communication between hosts</li>
<li>运输协议能提供的服务常常受限于底层网络层协议的服务模型</li>
<li>然而，即时底层网络协议不能在网络层提供相应的服务，运输层协议也能提供某些服务</li>
</ol>
</li>
<li>两种运输层协议：TCP&amp;UDP</li>
</ol>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MmM2YjAzMzBkNDc5MDMxOGUwNDRkMGQ0OGEwYWEyZDJfMWVSbHhHcWVnYU83OHY4OHZteEhsM1hzODV1YndpS2dfVG9rZW46RklhT2JPcXFvb0pVVVZ4c2haa2NtaThxbnNkXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<h2 id="3-2-Multiplexing-and-demultiplexing多路复用与多路分解"><a href="#3-2-Multiplexing-and-demultiplexing多路复用与多路分解" class="headerlink" title="3.2 Multiplexing and demultiplexing多路复用与多路分解"></a>3.2 Multiplexing and demultiplexing多路复用与多路分解</h2><ol>
<li>一个进程可能有一个或多个套接字，接收主机怎样将一个到达的运输层报文段定向到适当的套接字</li>
</ol>
<ul>
<li>Multiplexing as sender：handle data from multiple sockets, add transport header(later used for demultiplexing)</li>
<li>Demultiplexing as receiver：use header info to deliver received segments to correct socket</li>
</ul>
<ol>
<li>多路分解怎样work的</li>
</ol>
<p>Host receives IP datagrams. 每个IP数据报中有源IP地址和目的地IP地址，每个数据报还带有传输层报文，这个报文里面有源和目的地的端口号</p>
<p>Host uses IP addresses &amp; port numbers to direct segment to appropriate socket</p>
<ol>
<li>无连接的多路复用与多路分解connectionless demultiplexing</li>
</ol>
<p>当创建一个UDP socket时，运输层自动地为该socket分配一个端口号，UDP套接字由一个二元组全面标识的，中有目的地IP地址和目的地端口号</p>
<p>when receiving host receives UDP segment: checks <strong>destination port #</strong> in segment and directs UDP segment to socket with that port #，所以具有相同目的地端口号的报文段将通过相同的目的socket被定向到相同的目的进程</p>
<ol>
<li>面向连接的多路复用与多路分解connection-oriented demultiplexing</li>
</ol>
<ul>
<li>TCP套接字是由一个四元组标识的，中有源IP地址、源端口号、目的地IP地址、目的地端口号，这四个值全部都会被用上，所以具有不同源IP地址或源端口号的TCP报文段将被定向到两个不同的套接字（区别于UDP报文段）</li>
<li>服务器主机可以支持很多并行的TCP套接字，每个套接字与一个进程联系，并由其四元组来标识每个套接字</li>
</ul>
<ol>
<li>总结</li>
</ol>
<ul>
<li>UDP：多路分解只使用destination port number</li>
<li>TCP：多路分解使用四元组</li>
</ul>
<p>Multiplexing&#x2F;demultiplexing happen at all layers</p>
<h2 id="3-3-Connectionless-transport-UDP"><a href="#3-3-Connectionless-transport-UDP" class="headerlink" title="3.3 Connectionless transport: UDP"></a>3.3 Connectionless transport: UDP</h2><ol>
<li>为什么选用UDP</li>
</ol>
<ul>
<li>关于发送什么数据以及何时发送的应用层控制更为精细。TCP的拥具有拥塞控制机制，它保证报文的可靠交付，却不管可靠交付需要多少时间。实时应用通常要求最小的发送速率，不希望过分的延迟报文段的传送，且能容忍一些数据丢失。</li>
<li>无需连接建立。UDP不需要任何准备即可进行数据传输。</li>
<li>无连接状态。TCP需要在端系统中维护连接状态，包括接收和发送缓存、拥塞控制参数以及序号与确认号的参数。UDP不维护连接状态，也不追踪这些参数</li>
<li>分组首部开销小。每个TCP报文段都有20字节的首部开销，而UDP仅有8字节的开销</li>
</ul>
<ol>
<li>UDP常用于</li>
</ol>
<ul>
<li>流式多媒体streaming multimedia apps</li>
<li>DNS</li>
<li>SNMP网络管理数据</li>
<li>HTTP&#x2F;3（也可以通过在应用程序自身中建立可靠性机制来实现可靠数据传输）</li>
</ul>
<ol>
<li>UDP报文段结构</li>
<li>UDP检验和：为了确定当UDP报文段从源到达目的地移动时，其中的比特是否发送了改变</li>
</ol>
<p>怎样计算检验和：</p>
<p>将所有16比特的字相加，如果最后结果有溢出，则将溢出的那个数加到最后一个数上，得到的结果再取反码（所有的0换成1，所有的1换成0）</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NTQ4MjA3YzQ0N2E4Zjk5OTk1NzZkZGIwYmFlN2I3ODRfWFFPeDdPbkVZOWdoVnZUakFsWHBqZXhYaGkxN3R4YjJfVG9rZW46RW1mYmI1cllib2hJMlN4ckNZSmMzSmVUbnFkXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>在接收方，将原有的16比特的字连带检验和相加，和应该全是1，若某一比特为零，则出了差错</p>
<h2 id="3-4-Principles-of-reliable-data-transfer"><a href="#3-4-Principles-of-reliable-data-transfer" class="headerlink" title="3.4 Principles of reliable data transfer"></a>3.4 Principles of reliable data transfer</h2><ol>
<li>数据可以通过一条可靠的信道进行传输。借助于可靠信道，<strong>传输数据比特就不会收到损坏或丢失</strong>，而且所有数据都是<strong>按照其发送顺序进行交付</strong></li>
<li>讨论基于可靠数据传输协议的下层协议也许是不可靠的，如TCP是在不可靠（IP）端到端网络层之上实现的可靠数据传输协议</li>
<li>可靠传输协议的流程图</li>
</ol>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=YjU1OWVjZjYzYzNiNTlmZmUxNmNjOTg1NTY4NzIwYjVfeEZqbmRhdk1VeHBKaTdwSUhvcTN1aDRic3h5eEpLUFdfVG9rZW46TFZKN2JxQ2dYb3NEd054WVVEV2NYVHE5bmVlXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>可靠数据传输协议</li>
</ol>
<p>①rdt1.0: reliable transfer over a reliable channel经完全可靠信道的可靠数据传输</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ODM4MGFjMDQyY2M2Zjc2YTI4YmU5ZWM0ZWVlODdhYzFfalFqU2FVeXhLaXJveEEwcDhHd3Ewa1RJV1F6YzRwUktfVG9rZW46UDRPZmJsSVA3b3NvYkx4bzRQTmNmZ1FKbmxlXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ul>
<li>rdt的发送端只通过rdt_send(data)事件接受来自较高层的数据，产生一个包含该数据的分组，并将分组发送到信道中。rdt_send(data)事件是由较高层应用的过程调用产生的</li>
<li>在接收端，rdt通过rdt_rcv(packet)事件从底层信道接收一个分组，从分组中取出数据，并将数据上传给较高层。rdt_rcv(packet)事件是由较低层协议的过程调用产生的</li>
</ul>
<p>②rdt2.0: channel with bit errors经具有比特差错信道的可靠数据传输</p>
<ul>
<li>几个概念：<ul>
<li>ACKs(acknowledgements)：receiver explicitly tells sender that pkt received OK</li>
<li>NCKs(negative acknowledgements)：receiver explicitly tells sender that pkt had errors</li>
<li>ARQ(Automatic Repeat reQuest)协议：sender retransmits pkt on receipt of NAK自动重传请求</li>
<li>Stop and wait：sender sends one packet, then waits for receiver response（发送方不会发送一块新数据，除非发送方确定接收方已正确接收当前分组）</li>
</ul>
</li>
<li>状态图<ul>
<li><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZGEwMzM0ZWJiNjIwZDkzNTJjYTJkNDQ4M2Y2MDJiYmZfWUkwRXpIcTdWbEN1NGxYM3BNMnhjblNjNmZQUm5qcENfVG9rZW46TzI5NmJqbmtVb2YyZjl4Z3pRNmNXcU5kbkJoXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></li>
</ul>
</li>
</ul>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=YTUzZjUxM2U1ZDA0NTU3ZGE0OWViNDVkNTY1YjkyM2FfTktRMXN5RkFqR0hCVTRvTGdmQk9SeElYeXowU3VKbVRfVG9rZW46QUlBVWIzSzlvbzgya1V4dXIyN2NZRExlblpnXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ul>
<li>rdt2.0有一个致命错误：如果ACK&#x2F;NAK受损会怎样？<ul>
<li>如果一个ACK或NAK分组受损，发送方无法知道接收方是否正确接收了上一块发送的数据。此时不能直接重传retransmit，可能会造成重复duplicate</li>
</ul>
</li>
</ul>
<p>③rdt2.1：对于上述rdt2.0致命错误的处理</p>
<p>发送方和接收方的状态数都是以前的两倍，因为协议状态此时必须反映出目前正发送的分组或希望接收的分组的序号是0还是1</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=YzA4NTQyMTc1NGJjMzI5ZWU5MWU3ODIwOTMzNTZjYjFfd3RmWGE2T3pFWEVXR3k2dzQyUDFMWXBmNzVKNXFMdlFfVG9rZW46SjJwa2Iya1lZb0VRSVB4TzZCOWN3MVdsbk9iXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MzkwMjliNmU5ZDA4MjYxMTAyZWJmYmEyNzYwMTNkZDlfRXNoUzdEUUNSY3BmYmc2MEF4QndYV056aENMdE40YkhfVG9rZW46VHlMZ2JtdmtJb1M3OWd4dVdNcmNSTEVPblA3XzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>④rdt2.2：在有比特差错信道上实现的一个无NAK的可靠数据传输协议</p>
<p>和rdt2.1相比只是不用NAK而已</p>
<ul>
<li>instead of NAK, receiver sends ACK for last pkt received OK</li>
<li>duplicate ACK at sender results in same action as NAK: retransmit current pkt</li>
<li>TCP uses this approach to be NAK-free</li>
</ul>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=Yjg2OWY1N2JmZTI2MjRiNTkyYjllYjgyYjNlNDExOTJfSmxpZlU4NUJDUEVwTEFlaElzS0NIbVZwWkowNWMzVlJfVG9rZW46WEdNRWJkamFGb2dwZWR4S3l2WWMyWTlxbmFmXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>⑤rdt3.0: channels with errors and loss经具有比特差错的丢包信道的可靠数据传输</p>
<p>由于分组序号在0和1之间交替，rdt3.0也被称为比特交替协议</p>
<p>相当于在发送方处设置了一个倒计时：</p>
<p>发送方会在合理的时间内等待ACK</p>
<p>如果在此期间没有收到ACK，就会重新发送。</p>
<p>如果数据包（或ACK）仅被延迟（而不是丢失），则重传将是重复的</p>
<p>但是序列号已经处理了这个问题。接收方必须指定要ACK的数据包的序列号，这需要倒计时计时器。</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=M2Y3MDFkZDI0MmI2OTJkZmE5OWFiNzc4NmM3ZWQ4ZDBfQzRkY0ZjQkttMXlZNkVWUTZUMEpBV2I5Q0t2aDhGcUFfVG9rZW46WHlia2JWcjVBb2cyTnd4aWlMaGNkbDhrblJmXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>流水线可靠数据传输协议pipelining</li>
</ol>
<p>rdt3.0性能问题的核心在于它是一个停等协议。定义发送方（或信道）的利用率utilization为发送方实际忙于将发送比特送进信道的那部分时间与发送时间之比，即U_sender &#x3D; (L&#x2F;R) &#x2F; (RTT + L&#x2F;R)</p>
<p>解决这种性能问题的简单方法是：不以停等方式运行，允许发送方发送多个分组而无须等待确认</p>
<p>pipelining对于可靠数据传输协议的影响：</p>
<ul>
<li>必须增加序号范围</li>
<li>需要在发送方和接收方进行缓存，保证数据包的顺序</li>
</ul>
<p><strong>pipelining的差错修复有两种基本方法：</strong></p>
<ul>
<li>回退N步 Go-Back-N, GBN</li>
<li>选择重传 Selective Repeat, SR</li>
</ul>
<ol>
<li>GBN&#x2F;sliding-window protocol</li>
</ol>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=Y2EwNzg4MTNmNmM1YjE1MDE5NDdiMWM5OWNiYWIxZGJfQWhmSVl3NXRZRHM3Q3ozWGZOVnZsZXZxclZtd2dNZVpfVG9rZW46WW5Lc2JlSUdXb0VWZXJ4M1h5YWNvUGdwbjZjXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>发送方可以一次发送多个数据包，最多有N个未收到确认的数据包</p>
<p>接收方会回复一个累积确认，即只确认最后一个连续的数据包</p>
<p>如果接收方发现中间有一个数据包丢失了，它不会确认已经接收到的数据包，直到丢失的数据包被接收到为止</p>
<p>发送方会设置一个定时器来检测最早未收到确认的数据包</p>
<p>如果定时器超时，就会<strong>重新发送从这个未确认数据包开始的所有数据包</strong></p>
<p>action：当某个包丢失时，滑动窗口会停在丢失的那个处，因为它没有返回ack，下次sender发送pkt时，不会滑动到期望的地方，而是从丢失的这个处再发送包括它在内的前一次发送的后面的数字，如下图</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MGI2YzY2NGUxNDEwNWQwNjU0NjliMjMzNWY5YzE3MmVfa3BraEpwR2twNUJPdXJFejltY1RWYUU3ZDFWM2x6U1FfVG9rZW46UnZza2JKZ0xMb2lFUGJ4WVhLV2NHQUJEbkpjXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>选择重传：通过让发送方仅重传那些它怀疑在接收方出错的分组而避免不必要的重传</li>
</ol>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NWY4NmZjM2RkYWQ3OGNkNDY5MmI0M2QxNmYwNjA5OGVfYTlTSzhwY1pKdVF2aGZnd1l4OUZxakVLY3JxVTFFWjNfVG9rZW46TkZ5TmJDM2hab1Q2R3N4MjBIV2NTcjBhbjJlXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>发送方可以同时发送多达N个未确认的数据包，接收方会对每个已经接收到的数据包单独发送确认消息</p>
<p>发送方会为每个未确认的数据包分别维护一个定时器</p>
<p>当定时器超时时，只会重新发送该数据包，而不是之前未确认的所有数据包。</p>
<p>action：发送方只要收到了接收方传来的ACK滑动窗口就会往前移动一位；接收方如果收到的分组是当前滑动窗口的第一位，则交付分组、发送ACK并且往前移动一位，否则缓存分组，直到收到第一位的分组，则一次性交付缓存的连续分组，并移动窗口，即下面的两个方框所总结的：</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZGZiZjM1ZjRhZGY2MGZlYWI1NTg2MmIxMjc2Mjg0OGJfYmozSmh4RDFnUDdEZ3BKdzJKenRUY3dpbE5rdnl1TU9fVG9rZW46U1VmZmJISzhPb3d0T2h4MWtyVGNVSUtGbmFjXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>举例：</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=YTdkY2U2OWYyMzFlYjQ2YWYzNTVjNGY4ODRkOGFlMzZfQTFJRWtYR01VSlFobndka1lvR2JKNmo1VXZldldBSnlfVG9rZW46UzBWQ2JYQ2FFbzFQR2p4aHFOR2MzT09SbllmXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<h2 id="3-5-Connection-oriented-transport-TCP"><a href="#3-5-Connection-oriented-transport-TCP" class="headerlink" title="3.5 Connection-oriented transport: TCP"></a>3.5 Connection-oriented transport: TCP</h2><ol>
<li>Segment structure</li>
</ol>
<ul>
<li>与UDP一样：<ul>
<li>首部包括源端口号和目的端口号以及检验和字段</li>
</ul>
</li>
<li>首部还包括：<ul>
<li>32比特的序号字段（<strong>seq</strong>, sequence number field）和32比特的确认号字段（<strong>ACK</strong>, acknowledgment number field）<ul>
<li>一个报文段的序号就算该报文段数据字段首字节的序号</li>
<li>确认号是主机正在等待的数据的下一个字节序号</li>
</ul>
</li>
<li>16比特的接收窗口字段receive window field</li>
<li>4比特的首部长度字段header length field</li>
<li>可选与变长的选项字段options field</li>
<li>6比特的标志字段flag field</li>
</ul>
</li>
<li>往返时间RTT与重传超时间隔TimeoutInterval<ul>
<li>SampleRTT：从某报文段被发出到对该报文段的确认被收到之间的时间量。TCP仅为传输一次的报文段测量SampleRTT，绝不为已被重传的报文段计算</li>
<li>EstimatedRTT：由于SampleRTT值会随着路由器的拥塞和端系统负载的变化而波动，所有采取对其取平均的方式。一旦获得一个新的SampleRTT，TCP就会根据下列公式来更新EstimatedRTT：EstimatedRTT &#x3D; (1-alpha)*EstimatedRTT + alpha * SampleRTT，常取alpha为0.125（这种平均被称为指数加权移动平均EWMA）</li>
<li>DevRTT：用于估算SampleRTT偏离EstimatedRTT的程度，DevRTT &#x3D; (1-beta)<em>DevRTT + beta</em>|SampleRTT - EstimatedRTT|，SampleRTT波动越大，DevRTT值越大，常取beta为0.25</li>
<li>TimeoutInterval &#x3D; EstimatedRTT + 4*DevRTT （EstimatedRTT加上一定余量，当SampleRTT值波动较大时，这个余量应大一点）</li>
</ul>
</li>
</ul>
<ol>
<li>Reliable data transfer</li>
</ol>
<p>简化版：</p>
<p>TCP sender：三个事件</p>
<ul>
<li>event: data received from application</li>
<li>event: timeout</li>
<li>event: ACK received</li>
</ul>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZmZhYjY3OWNjOGRiNzQ2NjIzNTk3OGZmY2NlNGQ1MjdfRUtxcE8zTDRpSHVRbUNaVHFBRzZWNmVOTmR6UlkzOWtfVG9rZW46RHFOQ2J0M2lBb0hHRWp4SVBSTWNsTkZMbjVnXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>TCP receiver：ACK generation</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NjgzY2E0MThhYmU3OWQ5OTQzNDZlNWVkZDE5ZTUxMjNfMzZsaDZQaXJkMmZGUWE3SkRNUFc4TExQYTdpeWlFSFVfVG9rZW46TW1PbGJrdUM5b0l0OUN4WUV4SWNSb2xjbjZmXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>TCP快速重传fast retransmit：一旦收到3个冗余ACK，TCP就执行快速重传，即在该报文段定时器过期之前就重传丢失的报文段</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NTNlZTBlNmI0YjdmNDA0NTJkZWZlMDIxMjYwYTBjYzlfNWNuWW1xenVjVHFzOGRET0FMRXBsWWRseVNiZHZ2RXBfVG9rZW46SXhsd2JWOXJab1NKMDV4RmthdmM2d1BzbkFlXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>Flow control流量控制</li>
</ol>
<p>TCP通过让发送方维护一个接收窗口（receive window）的变量来提供流量控制。而由于TCP是bidirectory，所以在连接两端的发送方都各自维护一个接收窗口。</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=N2JlNThjYWQ1OTI5YWZjMmRkOWNkMmNmOGZhNjU4OGRfV0FmRlJKYVhmTWJKRHdsZnFxdnU4aEhHQ1NzN3JaTWxfVG9rZW46VVFzRGJZcE5Ib3VSakF4TnhzUmNYRk5ibmtnXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>rwnd &#x3D; RcvBuffer - [LastByteRcvd - LastByteRead]</p>
<p>发送方的主机A在该连接的整个生命周期须保证LastByteRead - LastByteAcked &lt;&#x3D; rwnd</p>
<p>TCP receiver “advertises” free buffer space in rwnd field in TCP header</p>
<ol>
<li>Connection management</li>
</ol>
<p>在发送包括数据的报文段之前client和server需要3次握手（three-way handshake）来创建连接</p>
<ul>
<li>为什么两次握手不行？<ul>
<li>为了实现可靠数据传输， TCP 协议的通信双方，都必须维护一个序列号，以标识发送出去的数据包中，哪些是已经被对方收到的。三次握手的过程即是通信双方相互告知序列号起始值，并确认对方已经收到了序列号起始值的必经步骤</li>
<li>如果只是两次握手，至多只有连接发起方的起始序列号能被确认，另一方选择的序列号则得不到确认</li>
</ul>
</li>
<li>建立连接&#x2F;三次握手过程：<ul>
<li>第一步：client端的TCP向server端的TCP发送一个SYN报文段，其中SYN比特被置为1，具有初始序号client_isn</li>
<li>第二步：server会从收到的数据报中提取TCP SYN报文段，为该TCP连接分配TCP缓存和变量，并向client发送允许连接的报文段SYNACK报文段，其中SYN被置为1，且包含server_isn</li>
<li>第三步：当client收到SYNACK报文段后，也要给该连接分配缓存和变量，并向server发送另一个报文段，此报文段对server允许连接的报文段进行确认（client通过将server_isn+1放置到TCP报文段首部的确认字段来完成该工作）。由于此时连接已经建立，所以该SYN被置为0</li>
<li>即client— SYN &#x3D; 1, seq &#x3D; client_isn —&gt; server</li>
<li>server— SYN &#x3D; 1, seq &#x3D; server_isn, ack &#x3D; client_isn+1 —&gt; client</li>
<li>client— SYN &#x3D; 0, seq &#x3D; client_isn + 1, ack &#x3D; server_isn+1 —&gt; server</li>
</ul>
</li>
<li>关闭一个TCP连接：<ul>
<li>client关闭— FIN&#x3D;1 —&gt; server</li>
<li>server— ACK —&gt; client</li>
<li>server关闭— FIN&#x3D;1 —&gt; client</li>
<li>client—ACK—&gt;server</li>
</ul>
</li>
</ul>
<h2 id="3-6-Principles-of-congestion-control"><a href="#3-6-Principles-of-congestion-control" class="headerlink" title="3.6 Principles of congestion control"></a>3.6 Principles of congestion control</h2><p>informally: “too many sources sending too much data too fast for network to handle”</p>
<p>三种情况（复杂度逐渐升高）：</p>
<ol>
<li>两个发送方和一台具有无穷大缓存的路由器</li>
</ol>
<p>两台主机（A和B）都有一条连接，且这两条连接共享源与目的地之间的单跳路由</p>
<ul>
<li>吞吐量只能拿到R&#x2F;2.这个吞吐量是由于两条连接之间共享链路容量造成的。无论主机A和主机B的发送速率设置为多高，都不可能超过R&#x2F;2的吞吐量</li>
<li>当分组的到达速率接近链路容量时，分组会有巨大的排队时延</li>
</ul>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NjJmNjc3YjNiNzFlOTY0ODRkNTQ5ZDFhZDU1NzI4NjJfdnkxcXRWdUdVMnNvR0V5cmlJOWNPZ1VaajhFd2FWeHZfVG9rZW46VjhvZ2JXWDZSb0txUHZ4NTBTdmNQWFowbjBiXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>两个发送方和一台具有有限缓存的路由器</li>
</ol>
<p>两个结果：当分组到达一个已满的缓存时会被丢弃；由于每条连接都是可靠的，所以被丢弃的分组会被发送方重传</p>
<p>三种情况：</p>
<ul>
<li>理想情况：sender sends only when router buffers available<ul>
<li><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZWM3OTBlZmYyM2E4YmVjMjE1N2YxNTQ3ZGQ1ZDU4OWRfbzJneVRzT09ER1FWdHRTNlpzTmN4SVNzNGlNVXdPdWdfVG9rZW46TG5KamJiSkE3b243Wml4RHlRWWNPaHc2bjljXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></li>
</ul>
</li>
<li>情况二：发送方仅当在确定了一个分组已经丢失时才重传<ul>
<li><p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NGYwOWE1MGI5NzBmMDkxMjY0NDY3ODEzYjA1MGQwODhfbTV1UWxiNXl6T1V5Z05SQXpDdENIeHdTcWdQZ0VvUGVfVG9rZW46VUlIMmJ3NVAwb1F0Vkx4enprV2NJYmNJbmpjXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
</li>
<li><p>网络拥塞的代价：发送方必须执行重传以补偿因为缓存溢出而丢弃&#x2F;丢失的分组</p>
</li>
</ul>
</li>
<li>情况三：发送方提前发生超时并重传在队列中已被推迟但还未丢失的分组<ul>
<li>网络拥塞的代价：发送方在遇到大时延时所进行的不必要重传会引起路由器利用其链路带宽来转发不必要的分组副本</li>
<li><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MDViMDQ1M2MzYTVjNjI5YmFiNzhmYzFhOWUwY2JlNGVfckFKaEcySUxjc2k5aGhjaDdoakNnUUR0OHE3RjlmaVRfVG9rZW46VFFEa2IyeWZGb1drTFd4Q0h6NmNGa0tlbkFiXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></li>
</ul>
</li>
</ul>
<ol>
<li>4个发送方和具有有限缓存的多台路由器及多跳路径</li>
</ol>
<p>不同的流量会在同一路由器处为有限缓存空间而竞争</p>
<p>网络拥塞的代价：当一个分组沿一条路径被丢弃时，每个上游路由器用于转发该分组到丢弃该分组而使用的传输容量最终被浪费掉了</p>
<ol>
<li>总结网络拥塞的代价</li>
</ol>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=YjFmMWEzYzI0OGQxYWQzYmYyYmFlMjFiMjE1Yzg0NGZfUTRiS2d6OERveWNmOXB4Mm5lT0xFdGpuWkdOMHdiN0xfVG9rZW46U2p6TmJ2U1dab3JyeXB4enZjVWNmczlNblRoXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>拥塞控制方法</li>
</ol>
<ul>
<li>端到端拥塞控制End-end congestion control<ul>
<li>no explicit feedback from network</li>
<li>congestion inferred from observed loss, delay</li>
<li>approach taken by TCP</li>
</ul>
</li>
<li>网络辅助的拥塞控制Network-assisted congestion control<ul>
<li>routers provide direct feedback to sending&#x2F;receiving hosts with flows passing through congested router</li>
<li>或者，路由器标记或更新从发送方流向接收方的分组中的某个字段来指示拥塞的产生，一旦收到一个标记的分组后，接收方会向发送方通知该网络拥塞指示（需要经过一个完整的往返时间）</li>
</ul>
</li>
</ul>
<h2 id="3-7-TCP-congestion-control"><a href="#3-7-TCP-congestion-control" class="headerlink" title="3.7 TCP congestion control"></a>3.7 TCP congestion control</h2><p>TCP拥塞控制方法：AIMD（让每一个发送方根据所感知到的网络拥塞程度来限制其能向连接发送流量的速率）</p>
<ol>
<li>AIMD具体细节</li>
</ol>
<ul>
<li>TCP发送方如何限制向其连接发送流量的<ul>
<li>运行在发送方的TCP拥塞控制机制跟踪一个额外的变量，即拥塞窗口cwnd。在一个发送方中未被确认的数据量不会超过cwnd与rwnd中的最小值，不过有时候忽略接收窗口的限制，则发送方的发送速率≈cwnd&#x2F;RTT 字节&#x2F;秒</li>
</ul>
</li>
<li>TCP拥塞控制算法：<ul>
<li>慢启动</li>
<li>拥塞避免</li>
<li>快速恢复（非必需）</li>
</ul>
</li>
</ul>
<ol>
<li>慢启动slow start</li>
</ol>
<ul>
<li>在慢启动状态，cwnd的值以1个MSS开始并且每当传输的报文段首次被确认就增加1个MSS（对每个报文段增加）。所以TCP发送速率起始慢，但在慢启动阶段以指数增长。</li>
</ul>
<p>cwnd &#x3D; initcwnd * 2^n</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MGFhOGUxYjJlYjVkZjJlM2IwZTQ0OWFiMjYyM2RmNTFfMWhyeGY5M3hKR3hEVWFEWG51SzBNOU16OVJSSDFJRG1fVG9rZW46SFhaZGJIZHo2b0FuWmR4SlhOMmNCMFNxbjQwXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ul>
<li>何时结束？<ul>
<li>法一：若存在一个由超时指示的丢包事件（即拥塞），TCP发送方将cwnd设置为1并重新开始慢启动过程，还将第二个状态变量的值ssthresh(慢启动阈值)设置为cwnd&#x2F;2（此过程用于记录下ssthresh的值，便于向下一过程转换）。当cwnd的值等于ssthresh时结束慢启动并且TCP转移到拥塞避免模式</li>
<li>法二：如果检测到3个冗余ACK，这时TCP执行一种快速重传并进入快速恢复状态</li>
</ul>
</li>
</ul>
<ol>
<li>拥塞避免</li>
</ol>
<p>一旦进入拥塞避免状态，cwnd的值大约是上次遇到拥塞时的值的一半（即拥塞并不遥远！）</p>
<p>此时每过一个RTT只将cwnd的值增加一个MSS，无论多少个报文段。即当cwnd&lt;ssthresh时，拥塞窗口使用慢启动算法，按指数级增长。当cwnd&gt;ssthresh时，拥塞窗口使用拥塞避免算法，按线性增长</p>
<p>何时结束？</p>
<ul>
<li>若由超时引起的丢包：TCP的拥塞避免算法行为与慢启动的情况一样，cwnd的值被设置为1个MSS，ssthresh的值被更新为cwnd值的一半</li>
<li>若由收到三个冗余的ACK引起的丢包：TCP将cwnd的值减半，当收到3个冗余的ACK时，将ssthresh的值记录为cwnd的值的一半，接下来进入快速恢复状态</li>
</ul>
<ol>
<li>快速恢复</li>
</ol>
<p>对于引起TCP进入快速恢复状态的缺失报文段，每当收到冗余的ACK，cwnd的值增加一个MSS。最终，当最后一个ACK到达时，TCP在降低cwnd后进入拥塞避免状态</p>
<p>如果出现超时事件，快速恢复在执行如同在慢启动和拥塞避免中相同的操作后，迁移到慢启动状态</p>
<p>当丢包事件出现时，cwnd的值被设置为1个MSS且ssthresh的值被设置为cwnd值的一半</p>
<ol>
<li>上述三个过程总结</li>
</ol>
<p>快速恢复不是必需的构件，三个状态没有先后顺序，可以相互转换</p>
<ol>
<li>TCP拥塞控制：AIMD（加性增，乘性减）</li>
</ol>
<p>即每个RTT内cwnd线性增加1MSS，然后出现3个冗余ACK事件时cwnd减半</p>
<ol>
<li>TCP CUBIC</li>
</ol>
<p>与TCP Reno有些许不同，仅当收到ACK时增加拥塞窗口，同时保持慢启动和快速恢复，仅改变拥塞避免阶段</p>
<p>W_max: sending rate at which congestion loss was detected</p>
<p>K: point in time when TCP window size will reach W_max</p>
<p>CUBIC以当前事件t和K之间距离的立方为函数来增加拥塞窗口，所以会更快地接近W_max，同时尽可能长时间地维持流仅低于拥塞门限</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=YjVlNjk1YWFiZjY2ZjBiODg1OGYxY2UxOGNlODAyMjRfNTRFMjVZRnlRZWRxVmdiRWd5djlvbmpkVndyNWlzdDJfVG9rZW46UUw5OWJvYUx3b2hUVHV4T01TVGNjTFpObjRSXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>网络辅助明确拥塞通告和基于时延的拥塞控制</li>
</ol>
<ul>
<li>明确拥塞通告ECN<ul>
<li>two bits in IP header (ToS field) marked by network router to indicate congestion</li>
<li>congestion indication carried to destination</li>
<li>destination sets ECE bit on ACK segment to notify sender of congestion</li>
<li>involves both IP (IP header ECN bit marking) and TCP (TCP header C,E bit marking)</li>
</ul>
</li>
<li>基于时延的拥塞控制Delay-based TCP congestion control<ul>
<li>Keeping sender-to-receiver pipe “just full enough, but no fuller”: keep bottleneck link busy transmitting, but avoid high delays&#x2F;buffering</li>
<li><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=YzA4MTVlNGFhODJkZDNhNzgwNWY2NWExOGZmZTM1ZDhfR0F5NHRVV0MycndUSWVDZXNSUkVVaTZGcU9Ucmc0aUJfVG9rZW46WG9yNGJWcDJ0b2p0cmF4VGxVMmNtTU9LbmpmXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></li>
</ul>
</li>
</ul>
<ol>
<li>TCP fairness公平性</li>
</ol>
<p>TCP是公平的，在理想情况下：</p>
<ul>
<li>Same RTT</li>
<li>fixed number of sessions only in congestion avoidance</li>
</ul>
<h2 id="3-8-Evolution-of-transport-layer-functionality运输层功能的演化"><a href="#3-8-Evolution-of-transport-layer-functionality运输层功能的演化" class="headerlink" title="3.8 Evolution of transport-layer functionality运输层功能的演化"></a>3.8 Evolution of transport-layer functionality运输层功能的演化</h2><p>主要介绍了QUIC（Quick UDP Internet Connections）：</p>
<h1 id="4-The-Network-Layer-the-Data-Plane"><a href="#4-The-Network-Layer-the-Data-Plane" class="headerlink" title="4 The Network Layer: the Data Plane"></a>4 The Network Layer: the Data Plane</h1><h2 id="4-1-Network-layer-overview"><a href="#4-1-Network-layer-overview" class="headerlink" title="4.1 Network layer: overview"></a>4.1 Network layer: overview</h2><ol>
<li>网络层的作用概述：将分组从一台发送主机移动到另一台接收主机</li>
</ol>
<ul>
<li>转发forwarding：move packets from a router’s input link to appropriate router output link（在网络层的数据平面）。<ul>
<li>在router内部，从router input port到router output port</li>
</ul>
</li>
<li>路由选择routing：determine route taken by packets from source to destination（在网络层的控制平面）<ul>
<li>在router之间，有两种方法：<ul>
<li>传统方法：运行在每台router中，每台router都包含转发和路由选择两种功能</li>
<li>SDN方法：物理上分离，远程控制器计算和分发转发表以供每台router使用。即路由选择设备仅执行转发，而远程控制器计算并分发转发表</li>
</ul>
</li>
</ul>
</li>
</ul>
<ol>
<li>网络服务模型Network Service Model</li>
</ol>
<p>定义了分组在发送与接收主机之间的端到端传输特性</p>
<p>因特网 尽力而为服务best-effort service：传送的分组既不能保证以它们发送的顺序接收，也不能保证它们最终交付，既不能保证端到端时延，也不能保证有最小的带宽</p>
<h2 id="4-2-What’s-inside-a-router"><a href="#4-2-What’s-inside-a-router" class="headerlink" title="4.2 What’s inside a router"></a>4.2 What’s inside a router</h2><ol>
<li>路由器结构</li>
</ol>
<ul>
<li>输入端口inpurt port</li>
<li>交换结构switching fabrics</li>
<li>输出端口output port</li>
<li>路由选择处理器routing processor</li>
</ul>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=YTFhY2U1ZTIwZTJlMjIyZTE1ODA4YWQ4ODRkZWNhM2ZfSEdOYmphcDBPWHpJdEFNQWVjN3VXd0ZBbUFYN0J5akpfVG9rZW46REIxdGJraDNvbzNNM1l4b0tHNmNhbUNMblFiXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>输入端口input port</li>
</ol>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MTJlYjI2NTA4MDU4ZGI4M2Y1N2VkYTlhNWIzMmNlNzdfbzd2SUd2eXlUNUlsRHd2WlMwWW45T2xoa0tJNU54OGFfVG9rZW46SXVjb2JFSXFyb2ZJaFV4TTVERmNDNUt5bnlnXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>最长前缀匹配规则longest prefix matching rule：在表中寻找最长的匹配项，并向最长前缀匹配相关联的链路接口转发分组</p>
<ol>
<li>交换switching fabrics</li>
</ol>
<p>transfer packet from input link to appropriate output link</p>
<p>三种交换方式：</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZTYzZDlmNzQ4OWY4MjY4Y2RkZDk4YWVhNWM1ZjA5ODJfN0JYa1ZacU5DMnJnakNZS3ltQ1FJTTFISUxqd2hDRENfVG9rZW46Vkh3cmJTUlpSb2gyQmF4SHFLaWNhVDh0bmtjXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ul>
<li>经内存交换memory<ul>
<li>在CPU（路由选择处理器）的直接控制下完成</li>
<li>分组先后被复制到路由选择处理器内存和输出端口的缓存中</li>
<li>不能同时转发两个分组，因为经过共享系统总线一次仅能执行一个内存读&#x2F;写</li>
</ul>
</li>
<li>经总线交换bus<ul>
<li>输入端口经一根共享总线将分组直接传送到输出端口，<strong>不需要路由选择处理器的干预</strong></li>
<li>该分组能被所有的输出端口收到，但只有与该标签匹配的端口才能保存该分组</li>
<li>一次只有一个分组能够跨越总线，故路由器的交换带宽受总线速率的限制</li>
</ul>
</li>
<li>经互联网络交换interconnection network<ul>
<li>NxN</li>
<li>能并行转发多个分组，但是如果来自两个不同输入端口的两个分组目的地为同一输出端口时，一个分组必须在输入端等待</li>
</ul>
</li>
</ul>
<ol>
<li>排队queuing</li>
</ol>
<ul>
<li>输入排队input port queuing<ul>
<li>Head-of-the-Line(HOL) blocking队列首部阻塞：在一个输入队列中排队的分组必须等待通过交换结构发送（即使输出端口是空闲的），因为它被位于队列首部的另一个分组所阻塞</li>
</ul>
</li>
<li>输出排队output port queuing<ul>
<li>当没有足够的内存来缓存一个入分组时，要么丢弃到达的分组（弃尾drop-tail），要么删除一个或多个已排队的分组为新来的分组腾出空间</li>
<li>在某些情况下，在缓存填满之前便丢弃一个分组&#x2F;或在其首部加上标记，这可以向发送方提供一个拥塞信号。称为主动队列管理AQM算法</li>
</ul>
</li>
<li>多少缓存才“够用”<ul>
<li>B &#x3D; RTT * C &#x2F; sqrt(N)，RTT为往返时延，C为链路容量，N为流的数量</li>
</ul>
</li>
</ul>
<ol>
<li>分组调度packet scheduling：排队的分组如何经输出链路传输</li>
</ol>
<ul>
<li>先进先出FIFO&#x2F;FCFS<ul>
<li>packets transmitted in order of arrival to output port</li>
</ul>
</li>
<li>优先权排队priority queuing<ul>
<li>到达输出链路的分组被分类放入输出队列中的优先权类（高优先权类和低优先权类）</li>
</ul>
</li>
<li>循环排队round robin（RR）<ul>
<li>分组被分类，但是类之间不存在严格的服务优先权。循环调度器在这些类之间轮流提供服务</li>
</ul>
</li>
<li>加权公平排队weighted fair queuing, WFQ<ul>
<li>与RR不同之处在于，每个类i被分配一个权w_i，类i将确保接收到的服务部分等于w_i&#x2F;(sigma w_j)，这也是类i得到的最小带宽</li>
</ul>
</li>
</ul>
<h2 id="4-3-IP-the-Internet-Protocol"><a href="#4-3-IP-the-Internet-Protocol" class="headerlink" title="4.3 IP: the Internet Protocol"></a>4.3 IP: the Internet Protocol</h2><ol>
<li>IPv4数据报格式</li>
<li>IP地址</li>
</ol>
<p>IP地址：4个字节（32比特），每个字节用它的十进制形式书写，各字节间以句点隔开（点分十进制记法）</p>
<p>每台主机和路由器接口都有自己的IP地址</p>
<ol>
<li>子网subnets</li>
</ol>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MDdjYThlNGUyOWE3YWYxNjg5MWQ0MGQ3Y2JiZjEyY2NfbXlEZG9aMmhPYTBnTWYwVnBIUFNTWGljdVpCeDVSNU1fVG9rZW46SHRFRWJSaVlFb3NDS3p4cFgzMmMybnA4blBmXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>IP地址为子网分配一个地址（子网掩码network mask）：223.1.1.0&#x2F;24</p>
<p>一个子网的IP定义并不局限于连接多台主机到一个路由器接口的以太网段，如路由器与路由器通过点对点链路连接，这个链路也是一个子网</p>
<p>因特网的地址分配策略：无类别域间路由选择 <strong>CIDR：</strong></p>
<ul>
<li>当使用子网寻址时，32比特的IP地址被划分为两部分：a.b.c.d&#x2F;x，x为地址第一部分subnet part的比特数</li>
<li>（网络）前缀：a.b.c.d&#x2F;x地址的x最高比特</li>
<li>路由聚合：使用单个网络前缀通告多个网络</li>
</ul>
<ol>
<li>IP地址：如何获取一块地址</li>
</ol>
<p>为了获取一块IP地址用于一个组织的子网内，网络管理员也许会与他的ISP联系，该ISP可能会从已分给它的更大地址块中提供一些地址。</p>
<p>获取主机host地址：<strong>动态主机配置协议DHCP（也叫即插即用协议plug-and-play）</strong></p>
<p>某组织一旦获得了一块地址，它就可为本组织内的主机与路由器接口逐个分配IP地址。以前常手工配置，现在更多采取DHCP来完成。</p>
<ul>
<li>给定主机每次与网络连接时能得到一个相同的IP地址或者被分配一个临时的IP地址</li>
<li>允许一台主机得知其他信息，如network mask、address of first-hop router for client、name and IP address of DNS sever</li>
</ul>
<p>DHCP是一个client-server协议，客户通常是新到达的主机，需要获得包括自身使用的IP地址在内的网络配置信息</p>
<p>每个子网具有一台DHCP服务器或DHCP中继代理（通常是一台路由器）</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=OWYyOTc0ZTMyMDIxMjZmODBmNTg5MTdiZjVhODU4ZTNfcnhtc1VJdnJOOUlCR3FvU1lIQVdnbUg0VUc4VDF0aVNfVG9rZW46TTZyZWJaY0tKb1FNdEV4dFBPRmNuMExEblhjXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>网络地址转换 network address translation, NAT</li>
</ol>
<p>用于在本地网络中使用私有地址，在连接互联网时转而使用全局IP地址的技术（改变了packet的source IP address和source port number）</p>
<p>为了解决IPv4地址短缺而开发的技术</p>
<ol>
<li>IPv6</li>
</ol>
<p>由于32比特的IPv4地址空间即将用尽</p>
<p>A. 数据报格式：</p>
<p>和IPv4相比：</p>
<ul>
<li>no checksum (to speed processing at routers)</li>
<li>no fragmentation&#x2F;reassembly</li>
<li>no options (available as upper-layer, next-header protocol at router)</li>
<li>扩大的地址容量，IPv6将IP地址长度从32比特增加到128比特</li>
<li>流标签。用于给特殊流的分组加上标签，这些特殊流是发送方要求进行特殊处理的流</li>
</ul>
<p>B. 从IPv4到IPv6的迁移</p>
<p><strong>建隧道tunneling</strong></p>
<p>假定两个IPv6节点要使用IPv6数据报进行交互，这时将两台IPv6路由器之间的中间IPv4路由器的集合称为一个隧道。借助于隧道，可将IPv6数据报放到一个IPv4数据报的数据字段中</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZTJkYjYzNmI1YmFkOGEwNTdmMzk3N2QyNTJkOTcwNDZfakpDb2QzOTk3NU9lNHc5YU9wZ2c3MElhWTl6bXViQ1VfVG9rZW46TVlzeWJ6bVpnb0ZmcUp4U1VNb2NvaEhVbkxkXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<h2 id="4-4Generalized-Forwarding泛化转发-SDN"><a href="#4-4Generalized-Forwarding泛化转发-SDN" class="headerlink" title="4.4Generalized Forwarding泛化转发, SDN"></a>4.4Generalized Forwarding泛化转发, SDN</h2><p>匹配加操作match plus action：查找目的IP地址，然后将分组发送到有特定输出端口的交换结构</p>
<p>匹配加操作转发表称为流表flow table，本质是个api：</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NDViNWU0YWRhNzUwZjU2ZmJlYTY3NzAwNGNlNDE5YjhfVDZ3NFJSVDk3a3M1cld5VEk1N05UMnk5VE5IY3oybVRfVG9rZW46RUNLRGJlYkIxb2RJeUR4NncyQWNPMG9MbkZmXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>Match plus action统一了不同的设备：</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NWU3MmYyZTczOTEzMDg3YjYxOGZhNDdiZWQzNDNmMDJfRDRqV0xyMmNCbmNyREFFQ0thVE9XWjBmdk1INURCOE5fVG9rZW46SXFGY2JreUhnb1RLVlV4SXozeWNJZDU5bmZlXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<h2 id="4-5-Middleboxes（防火墙"><a href="#4-5-Middleboxes（防火墙" class="headerlink" title="4.5 Middleboxes（防火墙"></a>4.5 Middleboxes（防火墙</h2><ol>
<li>中间盒定义：在源主机和目标主机之间的数据路径上执行除IP路由器的正常标准功能之外的任何中间框</li>
</ol>
<p>中间盒提供的三种服务：</p>
<ul>
<li>NAT转换</li>
<li>安全服务</li>
<li>性能增强</li>
</ul>
<ol>
<li>NFV网络功能虚拟化</li>
</ol>
<p>使用商用硬件（网络、计算和存储），并试图在通用软件堆栈之上构建专门的软件来实现这些服务</p>
<ol>
<li>互联网架构原则</li>
</ol>
<ul>
<li>IP沙漏</li>
</ul>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MGQyMDU5Njk3OTMyZDRjNGE5Y2ExYmUxNjA3MzJiYmFfV015VGNxYUdleUlPWE1MbGdWak9jSXRqZ0J2NWF1U3hfVG9rZW46QUNvN2IxazZWb2s0enB4SFU0MmNmZ0phbkFmXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZDVhZWMzNzY0MjU2YzIxOTk0M2RlM2Y1ZmUyODIyNDBfaDRKSDFXcmpkWko0Q2FpeXhQU0FtaHlSWndJTmQwRUNfVG9rZW46SVYwTGI4UnJYb3lKSFl4ajNsdGNaQ2tVbkJkXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ul>
<li>端到端原则</li>
</ul>
<h1 id="5-The-Network-Layer-the-Control-Plane"><a href="#5-The-Network-Layer-the-Control-Plane" class="headerlink" title="5 The Network Layer: the Control Plane"></a>5 The Network Layer: the Control Plane</h1><h2 id="5-1-introduction"><a href="#5-1-introduction" class="headerlink" title="5.1 introduction"></a>5.1 introduction</h2><p>转发表和流表是如何计算、维护和安装的</p>
<ul>
<li>每路由器控制per-router control(traditional)：<ul>
<li>每台路由器都运行一种路由选择算法</li>
<li>每台路由器中都包含转发和路由选择功能</li>
<li>每台路由器都有一个路由选择组件，用于与其他路由器中的路由选择组件通信</li>
<li>Eg. OSPF, BGP协议</li>
</ul>
</li>
<li>逻辑集中式控制logically centralized control(software defined networking)<ul>
<li>逻辑集中式控制器计算并分发转发表以供每台路由器使用的情况</li>
<li>控制器经一种良好的协议与每台路由器中的一个控制代理CA进行交互，这些CA既不能直接相互交互，也不能主动参与计算转发表</li>
</ul>
</li>
</ul>
<h2 id="5-2-routing-protocols"><a href="#5-2-routing-protocols" class="headerlink" title="5.2 routing protocols"></a>5.2 routing protocols</h2><p>路由选择算法目的：从发送方到接收方的过程中确定一条通过路由器网络的好的路径（等价于路由）</p>
<p>“good”: least “cost”, “fastest”, “least congested”</p>
<p>算法的分类：</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZjFlMGI0YjViN2IwN2IzY2FkMThmYTA1NGU1ZTY0MTdfUzF4TkhicVpybXh1M28wbndRWlpiekFCMG5qZUs1dEtfVG9rZW46VVVRaGJRUlBCb2h4YWp4SWVMcmNKZTNHblFkXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>Link state链路状态路由选择算法 LS</li>
</ol>
<p>集中式路由选择，具有全局状态信息</p>
<p>即Dijkstra算法，计算从某节点（源节点，我们称之为u）到网络中所有其他节点的最低开销路径</p>
<p>当LS算法终止时，对于每个节点，我们都得到从源节点沿着它的最低开销路径的前一节点</p>
<p>复杂度分析：</p>
<ul>
<li>算法复杂度O(n^2)或O(nlogn)</li>
<li>Message complexity：O(n^2)</li>
</ul>
<p>振荡：when link costs depend on traffic volume, route oscillations possible</p>
<p>如何防止振荡：a. 强制链路开销不依赖于所承载的流量（不可接受）；b. 确保并非所有的路由器都同时运行LS算法</p>
<ol>
<li>Distance vector距离向量路由选择算法 DV</li>
</ol>
<p>分散式路由选择</p>
<p>是一种迭代的、异步的、自我终止的和分布式的算法</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NmY0YTQ0ZDQwN2M5ZGZhYzg3OWEyZTgyYmQ5OWE3YmNfUVRzZGpWakVZNElTcGR6Y2tTS3NieG54WVROM2lmVFdfVG9rZW46TFRiNWJnNHplb0Ftbll4RXBLWmN6Rko0bnBjXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>min_v是对于x的所有邻居v来说的，所以必须通过遍历邻居v开始</p>
<p>D_x(y)即遍历x的每个邻居，再加上邻居到y的距离向量，然后更新</p>
<p>直到无更新报文发送为止</p>
<p>Key idea：</p>
<ul>
<li>from time-to-time, each node sends its own distance vector estimate to neighbors</li>
<li>when x receives new DV estimate from any neighbor, it updates its own DV using B-F equation:</li>
<li>under minor, natural conditions, the estimate D_x(y) converge to the actual least cost d_x(y)</li>
</ul>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZWYwYjQ0MGUzZmUzM2RmMTQ1ODg5OThmZjY3OGEwMTNfTHRRNDZGYUN5Y3Z4dzMzdGFxQTNhbE45QkpFem42TThfVG9rZW46VnFmdmJiMTBBbzJXeUR4T01KS2NkeWVibjBlXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>DV算法：链路开销改变与链路故障</li>
</ol>
<p>路由选择环路routing loop-&gt;无穷计数问题count-to-infinity</p>
<p>即good news travels fast while bad news travels slow</p>
<p>解决方法：毒性逆转poisoned reverse</p>
<p>如果z通过y路由选择到目的地x，则z将通告y，它（即z）到x的距离是无穷大。只要z经y路由选择到x，z就持续地向y讲述这个善意的小谎言</p>
<ol>
<li>LS与DV路由选择算法的比较</li>
</ol>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NWIxMjA5ZDBhY2VhNDExMzliODQwNjAzZGM1YmMzZmNfQzBYV3hLVDh3VmM5YVFJeVN3M2xrUkhCWHl0ZEVkdllfVG9rZW46Tm1TZ2JZN3RUb21IY0l4bGxrUmNrYmJPblpmXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>robustness方面，由于一个LS节点仅计算字节的转发表，所以路由技术在某种程度上是分离的，提供了一定程度的健壮性</p>
<p>而DV算法中一个不正确的节点计算值会扩散到整个网络</p>
<h2 id="5-3-intra-ISP-routing-OSPF"><a href="#5-3-intra-ISP-routing-OSPF" class="headerlink" title="5.3 intra-ISP routing: OSPF"></a>5.3 intra-ISP routing: OSPF</h2><ol>
<li>AS：Autonomous System，自洽系统</li>
</ol>
<p>每个AS由一组通常处在相同管理控制下的路由器组成，通常一个ISP中的路由器以及互联它们的链路构成一个AS</p>
<p>在相同AS中的路由器都运行相同的路由选择算法并且有彼此的信息，在不同AS中的路由器可以运行不同的域内路由协议</p>
<p>在一个自洽系统内运行的路由选择算法叫做自洽系统内部路由选择协议intra-autonomous system routing protocol</p>
<ul>
<li>intra-AS: routing among routers within same AS (“network”)</li>
<li>inter-AS: routing among AS’es</li>
</ul>
<ol>
<li>Intra-AS routing: routing within an AS</li>
</ol>
<ul>
<li>RIP: Routing Information Protocol<ul>
<li>classic DV: DVs exchanged every 30 secs</li>
<li>no longer widely used</li>
</ul>
</li>
<li>EIGRP: Enhanced Interior Gateway Routing Protocol<ul>
<li>DV based</li>
<li>formerly Cisco-proprietary for decades (became open in 2013 [RFC 7868])</li>
</ul>
</li>
<li>OSPF: Open Shortest Path First<ul>
<li><strong>link-state routing</strong></li>
<li>IS-IS protocol (ISO standard, not RFC standard) essentially same as OSPF</li>
</ul>
</li>
</ul>
<ol>
<li>OSPF 开放最短路优先</li>
</ol>
<p>Open: 公众可用的</p>
<p>OSPF是一种链路状态协议</p>
<p>each router floods OSPF link-state advertisements (directly over IP rather than using TCP&#x2F;UDP) to all other routers in entire AS</p>
<ol>
<li>OSPF的结构</li>
</ol>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NWY4YzA5Y2MzYjVlOGJhOGNmMmIyZDAwMGM5NzFmNzVfTEJydmtWQmJaZUZZWGtXWFVuQ0lFaEFkMWhlM0pkenNfVG9rZW46UjVzT2JWanBDb0JIcDR4a0lib2NFallyblZmXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<h2 id="5-4-routing-among-ISPs-BGP"><a href="#5-4-routing-among-ISPs-BGP" class="headerlink" title="5.4 routing among ISPs: BGP"></a>5.4 routing among ISPs: BGP</h2><ol>
<li>Internet inter-AS routing: BGP（Border Gateway Protocol）</li>
</ol>
<p>在因特网中，所有的AS运行相同的AS间路由选择协议，称为边界网关协议BGP</p>
<p>BGP为每个AS一种手段来完成下列的任务：</p>
<ul>
<li>obtain destination network reachability info from neighboring ASes（eBGP）</li>
<li>determine routes to other networks based on reachability information and policy</li>
<li>propagate reachability information to all AS-internal routers (iBGP)</li>
<li>advertise (to neighboring networks) destination reachability info</li>
</ul>
<ol>
<li>eBGP, iBGP connections</li>
</ol>
<p>对于每个AS，每台路由器要么是一台网关路由器gateway router，要么是一台内部路由器internal router。</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MzcwMzZhZGUyNzRkNmI5YjY4MTJlOWZmNjk2ZjJmMjJfelZCb0FqWlFNWndZMlR2MnNacmNsQWZXaTVaQmZkeEJfVG9rZW46R05BVWJhTXB3b1hKYk14bXhXdWNCT0E2bnFmXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>BGP session: two BGP routers (“peers”) exchange BGP messages over semi-permanent TCP connection:<ol>
<li>advertising paths to different destination network prefixes (BGP is a “path vector” protocol)</li>
</ol>
</li>
<li>BGP advertised route: prefix + attributes<ol>
<li>prefix: destination being advertised</li>
<li>two important attributes:<ul>
<li>AS-PATH: list of ASes through which prefix advertisement has passed通告已经通过的AS的列表</li>
<li>NEXT-HOP: indicates specific internal-AS router to next-hop AS</li>
</ul>
</li>
</ol>
</li>
<li>BGP路由选择算法</li>
</ol>
<ul>
<li>热土豆路由选择hot potato routing<ul>
<li>从所有可能的路由中选择的路由到开始该路由的NEXT-HOP路由器具有最小开销（选择具有最小最低开销的网关）</li>
</ul>
</li>
<li>在实践中，BGP顺序地调用下列消除规则直到余下一条路由：<ul>
<li>local preference value attribute: policy decision</li>
<li>shortest AS-PATH</li>
<li>closest NEXT-HOP router: hot potato routing</li>
<li>additional criteria</li>
</ul>
</li>
</ul>
<ol>
<li>路由选择策略</li>
</ol>
<p>ISP only wants to route traffic to&#x2F;from its customer networks (does not want to carry transit traffic between other ISPs</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ODFjODAyYmM5MWJlN2QzYTAwNjY1ZDlhYzZmMTI0NTRfdW5aWFRETlJoOWloWGZWZHNOdEE4NTEwUFdSYklJZ29fVG9rZW46VW15MWI5UFJIb0huemh4V05LRWM2dkhVblRmXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<h2 id="5-5-SDN-control-plane"><a href="#5-5-SDN-control-plane" class="headerlink" title="5.5 SDN control plane"></a>5.5 SDN control plane</h2><ol>
<li>SDN体系结构的四个关键特征</li>
</ol>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=OTJiNTA2MmFkNjU3MzJkODIyNjNjZGNjNzZkMDIxYjBfVzNEb2lDUk5VS0g1M3kzMEM0Znl6eU4xeFhSNWJqZkpfVG9rZW46WnNFVmJMUVl4b3M1dmV4cThoVWNtSDdwbk1nXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>SDN体系结构组件</li>
</ol>
<ul>
<li>SDN控制的交换机 Data-plane switches<ul>
<li>protocol for communicating with controller (e.g., OpenFlow)</li>
</ul>
</li>
<li>SDN控制器 SDN controller (network OS)<ul>
<li>maintain network state information</li>
<li>通过northbound api与网络控制应用程序交互，通过southbound api与交换机交互</li>
<li>implemented as distributed system</li>
</ul>
</li>
<li>网络控制应用程序 network-control apps</li>
</ul>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NTE2Y2I1M2U0MGNmYjhiOTM3NGNhMTIxNzQ2OTY1MWJfbjlRMW9SREZqNmNnSWFTWVhRb1RDUlhQeXpLNUYzRlhfVG9rZW46UmdiUGJwS1Job1kweHh4UEM0UmNPQ1FJblNmXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>OpenFlow协议</li>
</ol>
<ul>
<li>operates between controller, switch</li>
<li><strong>TCP</strong> used to exchange messages</li>
<li>Key controller-to-switch messages：<ul>
<li>features读状态: controller queries switch features, switch replies</li>
<li>configure配置: controller queries&#x2F;sets switch configuration parameters</li>
<li>modify-state修改状态: add, delete, modify flow entries in the OpenFlow tables</li>
<li>packet-out发送分组: controller can send this packet out of specific switch port</li>
</ul>
</li>
<li>Communication between SDN controller and controlled switches</li>
<li>Key switch-to-controller messages：<ul>
<li>packet-in分组入: transfer packet (and its control) to controller. See packet-out message from controller</li>
<li>flow-removed流删除: flow table entry deleted at switch</li>
<li>port status端口状态: inform controller of a change on a port.</li>
</ul>
</li>
</ul>
<ol>
<li>Control plane and data plane interaction</li>
<li>SDN控制器几个例子</li>
</ol>
<p>A. ORION: Google’s SDN control plane (NSDI’21): control plane for Google’s datacenter (Jupiter) and wide area (B4) networks</p>
<p>B. OpenDaylight (ODL) controller：</p>
<ul>
<li>SAL（Service Abstraction Layer，服务抽象层）</li>
</ul>
<p>C. ONOS controller</p>
<ul>
<li>独有特征：意图框架intent framework：允许应用程序请求高层服务，而不必知道该服务的执行细节</li>
</ul>
<h2 id="5-6-Internet-Control-Message-Protocol"><a href="#5-6-Internet-Control-Message-Protocol" class="headerlink" title="5.6 Internet Control Message Protocol"></a>5.6 Internet Control Message Protocol</h2><ol>
<li>ICMP：因特网控制报文协议，被主机和路由器用来彼此沟通网络层的信息</li>
</ol>
<p>典型用途：差错报告。例如，如果IP路由器不能找到一条通往HTTP请求中所指定的主机的路径，该路由器就会向你的主机生成并发出一个ICMP报文以指示该错误</p>
<ul>
<li>error reporting: unreachable host, network, port, protocol</li>
<li>echo request&#x2F;reply (used by ping)</li>
</ul>
<p>network-layer “above” IP: ICMP messages carried in IP datagrams（ICMP通常被认为是IP的一部分，但是从体系结构上讲它位于IP之上）</p>
<p>ICMP message: type, code plus first 8 bytes of IP datagram causing error</p>
<ol>
<li>Traceroute and ICMP</li>
</ol>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=YTlmMTVjYjU0YWQ3MjVhNmNjYTk4MjRhMzYxOWExY2VfVWRrb0JVM1A3MXRZOHhvd2ZhVnRNR1FzejJjeXdBcFBfVG9rZW46Rm9pVmJlelpZb3pJN2l4MllMWmNKZHI0bkNiXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<h1 id="6-The-Link-Layer"><a href="#6-The-Link-Layer" class="headerlink" title="6 The Link Layer"></a>6 The Link Layer</h1><h2 id="6-1-introduction"><a href="#6-1-introduction" class="headerlink" title="6.1 introduction"></a>6.1 introduction</h2><ol>
<li>专有名词</li>
</ol>
<p>运行链路层协议的任何设备均称为节点，包括主机、路由器、交换机和WIFI接入点</p>
<p>沿着通信路径连接相邻节点的通信信道称为链路link</p>
<ol>
<li>链路层提供的服务</li>
</ol>
<ul>
<li>Framing成帧，link access</li>
<li>reliable delivery between adjacent相邻的 nodes</li>
<li>flow control</li>
<li>error detection</li>
<li>error correction</li>
<li>half-duplex and full-duplex</li>
</ul>
<ol>
<li>链路层的实现与交互</li>
</ol>
<p>大多数情况下，链路层是在称为网络适配器的芯片上实现的，有时也称为网络接口控制器（NIC）</p>
<p>attaches into host’s system buses</p>
<p>链路层控制器的大部分功能是在硬件中实现的</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=YTM5NzRlNTk1NWJiMGY2NDEwNWNkMzhiNWJkZjljZjRfSzFjU1Z2Vm5lOXBITUFWZU1WNDVMY3dVbTh1WURXdXVfVG9rZW46T2V4M2JpUmpZb2RMaWV4Tmd2UGNGRWdMbjdkXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<h2 id="6-2-error-detection-correction"><a href="#6-2-error-detection-correction" class="headerlink" title="6.2 error detection, correction"></a>6.2 error detection, correction</h2><p>EDC: error detection and correction bits</p>
<p>差错检测不是100%有效</p>
<p>larger EDC field yields better detection and correction</p>
<p>三种方法：</p>
<ol>
<li>奇偶校验 parity checking</li>
</ol>
<p>A. 单比特奇偶校验single bit parity</p>
<p>要发送的信息D有d比特，在偶校验方案中，发送方只需要包含一个附加的比特，选择它的值，使得这d+1比特中1的总数是偶数（奇校验同理）</p>
<p>接收方只需数一数接收的d+1比特中1的数量即可</p>
<p>单比特奇偶校验若检测到error，则一定有error；若没有检测到error，则不一定没有error</p>
<p>B. 二维奇偶校验two-dimensional parity</p>
<p>包含行和列</p>
<p>可以通过行和列的索引来识别并纠正发送差错的比特</p>
<p>能检测但不能纠正一个分组中两个比特差错的任何组合</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NTIyOGM4ZWRmYWMwMTQwMTYxMDM1YWVhMTc4Yjg5Yzlfb1lhc1V3SmZUdmdaMDJJSmlVRGVGVTF1eElHTXpGQ3JfVG9rZW46THV2dmJHWDIybzFUNkt4Q0ppSWNZS2J5bkloXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>避免了重传——&gt;前向纠错FEC：接收方检测和纠正差错的能力，可以减少所需的发送方重发的次数，允许在接收方立即纠正差错，而不是让发送方重传一份正确的。从而避免了不得不等待的往返时延</p>
<ol>
<li>因特网检验和 Internet checksum</li>
</ol>
<p>见3.3节</p>
<ol>
<li>循环冗余检测 CRC</li>
</ol>
<ul>
<li>D：被发送的数据比特，d比特</li>
<li>R：附加比特，默认为0，r比特</li>
<li>G：生成多项式，r+1比特</li>
</ul>
<p>用G去除接收到的d+r比特，如果余数为非零，则接收方知道出现了差错，否则认为数据正确而被接收</p>
<p><strong>这里的“除”是取异或的意思</strong></p>
<p>R &#x3D; remainder(D*2^r&#x2F;G)</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=YzQ1ODA1N2I4YmZiYWQ4OTdiYmFmZGI1NWRlNzg1OTFfenZYZG5YYkVnWjFpVXJuWUtFaHFrSXBrZTRrM1FnM0FfVG9rZW46SE9kVWJXdmR3b3hGekt4bUt6Y2NxcG15blVlXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<h2 id="6-3-multiple-access-protocols多路访问链路和协议"><a href="#6-3-multiple-access-protocols多路访问链路和协议" class="headerlink" title="6.3 multiple access protocols多路访问链路和协议"></a>6.3 multiple access protocols多路访问链路和协议</h2><ol>
<li>两种网络链路：</li>
</ol>
<ul>
<li>点对点链路point-to-point link<ul>
<li>由链路一端的单个发送方和链路另一端的单个接收方组成</li>
<li>point-to-point link between Ethernet switch, host</li>
<li>PPP for dial-up access</li>
</ul>
</li>
<li>广播链路broadcast link（shared wire or medium）<ul>
<li>能让多个发送和接收节点都连接到相同的、单一的、共享的广播信道上</li>
<li>old-school Ethernet</li>
<li>upstream HFC in cable-based access network</li>
<li>802.11 wireless LAN, 4G&#x2F;4G. satellite</li>
</ul>
</li>
</ul>
<ol>
<li>多路访问协议multiple access protocol</li>
</ol>
<p>一个理想的多路访问协议：</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MWRiNjk2NzA2MmE3NmQyNzY4YTA4YTU1MTk1MDQwZWRfZmdHNjM4MHh0UGlHREQ2bzc1aldnc0JHT1lNVlN5NTZfVG9rZW46TXFDdWJ5YXN2b1FJSTN4QnFwYmNvVlNBbnRkXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>多路访问协议的三种类型：</p>
<ul>
<li>信道划分协议channel partition protocol<ul>
<li>将channel分成小的部分，如time slots, frequency, code</li>
<li>将片段划分给节点，以供独家使用</li>
<li>4G, 5G</li>
</ul>
</li>
<li>随机接入协议random access protocol<ul>
<li>channel not divided, allow collisions</li>
<li>“recover” from collisions</li>
<li>Erthernet, WiFi</li>
</ul>
</li>
<li>轮流协议taking-turns protocol<ul>
<li>nodes take turns, but nodes with more to send can take longer turns</li>
</ul>
</li>
</ul>
<ol>
<li>信道划分协议</li>
</ol>
<ul>
<li>时分多路复用TDMA<ul>
<li>将时间划分为时间帧time frame，并进一步划分每个时间帧为N个时隙slot，然后把每个时隙分配给N个节点中的一个</li>
<li>选择的时隙长度应使一个时隙内能够传输单个分组</li>
<li>没有被使用的时隙处于空闲状态idle</li>
<li>优缺点：<ul>
<li>优点：避免了碰撞，十分公平，每个节点在每个帧时间内得到了专用的传输速率R&#x2F;N bps</li>
<li>缺点：节点被限制于R&#x2F;N bps的平均速率，哪怕它是唯一有分组要发送的节点</li>
</ul>
</li>
</ul>
</li>
<li>频分多路复用FDMA<ul>
<li>将R bps信道划分为不同的频段，每个频道都有R&#x2F;N带宽，并把每个频率分配给N个节点中的一个</li>
<li>优缺点与TDMA类似</li>
</ul>
</li>
<li>码分多址CDMA<ul>
<li>TDMA和FDMA分别为节点分配时隙和频率，CDMA为每个节点分配一种不同的编码，然后节点用它唯一的编码对它发送的数据进行编码</li>
<li>不同的节点可以同时传输（利用编码），不会互相干扰</li>
</ul>
</li>
</ul>
<ol>
<li>随机接入协议</li>
</ol>
<p>A. 概念</p>
<ul>
<li>一个传输节点总是以信道的全部速率（即R bps）进行发送，当有碰撞时，涉及碰撞的每个节点反复地重发它们的分组，到该分组无碰撞地通过为止</li>
<li>遇到碰撞后独立地选择随机时延，重发分组</li>
</ul>
<p>B. 随机接入协议的例子：</p>
<ul>
<li>ALOHA, slotted ALOHA</li>
<li>CSMA, CSMA&#x2F;CD, CSMA&#x2F;CA</li>
</ul>
<p>C. Slotted ALOHA:</p>
<ul>
<li>时间被划分成长度为L&#x2F;R秒的时隙（即传输一帧的时间）</li>
<li>节点只在时隙开始的时候传输帧，以全速R传输</li>
<li>如果大于等于2个节点在同一个时隙里传帧，则发生碰撞</li>
<li>发生碰撞后节点会以概率p在后续的每个时隙中重传它的帧，直到传出去为止</li>
</ul>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NDA5Y2E3MDAwYTE2ZjMxNzQxM2FmMDI5MmU3ZWEzYjlfSmlrQ0k1N0JJMXRCVnN1MnhOUzlFMVBvb2hON2xvdWNfVG9rZW46UDhhRWJVbmRJb29tUWJ4bWhtV2NvYjBxbllmXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ul>
<li>时隙多路访问协议的效率efficiency：当有大量的活跃节点且每个节点总有大量的帧要发送时，长期运行中成功时隙的份额<ul>
<li>Max efficiency: 1&#x2F;e ≈ 37%（相似的分析，37%时隙是空闲的，26%时隙有碰撞）</li>
</ul>
</li>
</ul>
<p>D. Pure ALOHA</p>
<ul>
<li>与时隙ALOHA相比，纯ALOHA每个节点的运输不是同步的，这带来了更大可能性的碰撞</li>
<li>Max efficiency: 1&#x2F;2e ≈ 18%</li>
</ul>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZjU3MmY4ZWQ5NTAzNDdmOGEzNWU1MTkxODU4NTViOWJfWmNteVJDaVh4VzZwczR1T1F1Mk5paFhQN0NqeWZ2Z3BfVG9rZW46UzNvUGJyMThNb2dmYUt4Y2p5RWNYbmlWbnRnXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>E. 载波侦听多路访问CSMA</p>
<p>载波侦听carrier sensing：easy in wire, hard in wireless</p>
<ul>
<li>CSMA：listen before transmit<ul>
<li>由于有端到端信道传播时延(channel propagation delay)，所以尽管所有的节点都在进行载波侦听，也会有碰撞。且传播时延越长，载波侦听节点不能侦听到网络中另一个节点已经开始传输的机会越大</li>
<li></li>
</ul>
</li>
<li>CSMA&#x2F;CD：CSMA with collision detection<ul>
<li>减少了在碰撞上浪费的时间</li>
<li>transmission aborted on collision detection（只能检测碰撞冲突，无法避免；CSMA&#x2F;CA不能检测冲突，只能尽量避免）</li>
</ul>
</li>
</ul>
<p>Erthernet CSMA&#x2F;CD algorithm：</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MWFkNGVjNTZjOWQ2ZGJiOTI3MDIxMjllYzE4NDAzNDhfTml4V09wdVpDQ1A2TjJVY0RNSlBlUWs4VGRUUFROYzFfVG9rZW46UVJ0SGJ2NmRJb2VwUVN4a1ZuUWNhUjl1bmRlXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<p>CSMA&#x2F;CD efficiency：</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=OTY3YzA4MmEzYzI1ZWVhYjljNjdkYmJkZWYwOTZkMzBfSllESHAwcHJxWVNKblpnWFlBdzBWTHZSaDV2TGRsMHBfVG9rZW46VTJhTmJ5aVhIb1FjM0Z4V1hTbGN3WlphbndnXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>轮流协议</li>
</ol>
<p><strong>channel partitioning MAC protocols在high load下高效，random access MAC protocols在low load下高效，而take turns尝试拥有both</strong></p>
<ul>
<li>轮询协议polling<ul>
<li>要求节点之一被指定为主节点，主节点以循环的方式轮询每个节点。即主节点首先向节点1发送一个报文，告诉节点1能够传输帧的最多数量，在节点1传输了某些帧后，主节点再转向节点2……</li>
<li>蓝牙Bluetooth使用的就是轮询协议</li>
<li>优点：避免了碰撞和空时隙</li>
<li>缺点：<ul>
<li>引入了轮询延迟</li>
<li>主节点可能出现故障</li>
</ul>
</li>
</ul>
</li>
<li>令牌传递协议token passing<ul>
<li>没有主节点，一个被称为令牌的小的特殊帧在节点之间以某种固定的次序进行交换</li>
<li>transmit while holding token</li>
<li>优点：令牌是分散的，效率高</li>
<li>缺点：一个节点的故障可能导致整个信道崩溃</li>
</ul>
</li>
</ul>
<ol>
<li>Cable access network有线接入网: FDM, TDM and random access</li>
</ol>
<h2 id="6-4-LANs"><a href="#6-4-LANs" class="headerlink" title="6.4 LANs"></a>6.4 LANs</h2><h3 id="6-4-1-addressing-ARP"><a href="#6-4-1-addressing-ARP" class="headerlink" title="6.4.1 addressing, ARP"></a>6.4.1 addressing, ARP</h3><p>主机和路由器（的适配器&#x2F;网络接口）都有链路层地址，而ARP（地址解析协议）就是提供了将IP地址转换为链路层地址的机制</p>
<ol>
<li>MAC地址</li>
</ol>
<p>具有多个网络接口的主机将具有与之相关联的多个链路层地址</p>
<p>MAC地址长度为6字节，通常用十六进制表示法</p>
<p>没有两块适配器具有相同的地址</p>
<p>MAC地址具有扁平结构（区别于IP地址分为网络部分和主机部分），can move interface from one LAN to another</p>
<ol>
<li>地址解析协议ARP</li>
</ol>
<p>ARP将一个IP地址映射为一个MAC地址，且<strong>只为同一个子网上</strong>的主机和路由器接口解析IP地址</p>
<p>每台主机或路由器在其内存中具有一个ARP table，格式&lt;IP address, MACaddress, TTL&gt;,TTL（Time to Live）为从表中删除这个映射的时间</p>
<p>ARP协议具体做法：</p>
<ul>
<li>如果发送方的ARP表具有该目的节点的表项，则done</li>
<li>如果没有，则需要构造ARP packet（包含IP src, IP dst, MAC src, MAC dst），使用MAC广播地址来发送这个分组</li>
</ul>
<ol>
<li>发送数据报到子网外</li>
</ol>
<p>MAC的src和dest是根据当前的发送方和接收方决定的，在传递过程中会被更改。而IP的src和dest是根据整体的源和目的地决定的，在传递过程保持不变</p>
<h3 id="6-4-2-Erthernet"><a href="#6-4-2-Erthernet" class="headerlink" title="6.4.2 Erthernet"></a>6.4.2 Erthernet</h3><p>first widely used LAN technology</p>
<p>从bus改为switched：</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZmY3ZTdlOGEwMDg0MTRmOTA4ZWM2M2I1MGZlNDUxMTlfMWRSTE5IOG14UnQ5REUwNXplcFZrWGRFOWw3eHFMa2VfVG9rZW46WXVVT2J1RVg4bzc4aUx4WjFEdmNzQkRHbkVxXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>帧结构frame structure</li>
</ol>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NDllZmE5OGI1YmQ5ZGQ1ZTk2OTA2NGU3NzAzMzIwYTBfY1Z4aDF2anBOaGE3dXo5cWpBaHcwTVRFdnBnTnJZUktfVG9rZW46UkRFeGJuTzhhbzhVeHp4aHQyTWNGeVVpbm1iXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>Ethernet: unreliable, connectionless</li>
</ol>
<ul>
<li>Unreliable：receiving NIC doesn’t send ACKs or NAKs to sending NIC</li>
<li>Connectionless：no handshaking between sending and receiving NICs</li>
<li>Ethernet’s MAC protocol: unslotted CSMA&#x2F;CD with binary backoff</li>
</ul>
<h3 id="6-4-3-switches"><a href="#6-4-3-switches" class="headerlink" title="6.4.3 switches"></a>6.4.3 switches</h3><p>transparent: hosts unaware of presence of switches</p>
<p>plug-and-play, self-learning：switches do not need to be configured</p>
<p>switch可以同时进行多个传输，由于Ethernet protocol used on each incoming link，所以有着不同目的地的传输是无碰撞且为双全工（full-duplex）</p>
<p>有着相同目的地的传输会发生碰撞！</p>
<ol>
<li>Switch forwarding table</li>
</ol>
<p>Filtering and forwarding is completed by switch table</p>
<p>each switch has a switch table, each entry:</p>
<ul>
<li><strong>(MAC address of host, interface to reach host, time stamp)</strong></li>
<li>looks like a routing table!</li>
</ul>
<p>假设目的地址为DD-DD-DD-DD-DD-DD的帧从交换机接口x到达，交换机用MAC地址索引它的表，可能有3种可能的情况：</p>
<ul>
<li>表中没有对应MAC地址的表项：交换机广播该帧</li>
<li>表中有MAC地址与接口x关联的表项：丢弃该帧执行过滤功能</li>
<li>表中有MAC地址与接口y≠x关联的表项：通过将该帧放到接口y前面的输出缓存完成转发功能</li>
</ul>
<ol>
<li>Self-learning</li>
</ol>
<p>switch learns which hosts can be reached through which interfaces</p>
<p>交换机存储在每个接口接收到的入帧的信息，且在一段时间（老化期aging time）后，如果交换机没有接收到以该地址作为源地址的帧，就在表中删除这个地址</p>
<h3 id="6-4-4-VLANs"><a href="#6-4-4-VLANs" class="headerlink" title="6.4.4 VLANs"></a>6.4.4 VLANs</h3><ol>
<li>虚拟局域网virtual LANs：VLANs</li>
</ol>
<p>为了解决被配置为等级结构的局域网的一些问题，如隐私、效率等</p>
<p>port-based VLAN: switch ports grouped (by switch management software) so that single physical switch operates as multiple virtual switches）</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NjZlYTgyZDBkMTg3YjRkODRjNjMxN2FlYWI0NDRhMTVfWVVaT216VkhzUEVBM1AyalZJYUx4WUpQR2dlV1Z3bHBfVG9rZW46UGEwOWJ2RFprb29pdVZ4MjlqYmNVM1hGbmlnXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>跨多个switches的VLANs</li>
</ol>
<p>VLAN干线连接VLAN trunking：每台交换机上的一个特殊端口被配置为干线端口，发送到任何VLAN的帧经过干线链路转发到其他交换机</p>
<p>802.1Q：一种扩展的以太网帧格式，用于解决到达干线端口的帧属于哪个特定的VLAN问题</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=M2IxY2ZkZDhhNDExZDJlMTc3OTgyOGZiNzNlNTIzN2RfT0x4ZExxMmxra0JVSzIwM0VSNGg4TjBHQk9TUFFyOWZfVG9rZW46RENjTmJmMmhHb1NpY2p4UENDVmNNVnQyblZkXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<h2 id="6-5-link-virtualization-MPLS"><a href="#6-5-link-virtualization-MPLS" class="headerlink" title="6.5 link virtualization: MPLS"></a>6.5 link virtualization: MPLS</h2><p>多协议标签交换Multiprotocol Label Switching, MPLS</p>
<ol>
<li>goal：改善IP路由器的转发速度</li>
</ol>
<p>faster lookup using fixed length identifier</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MDM5N2FmZjM0OGVmMjc0ODY5NDBlMjAyYTZkMDFkY2RfYWFlWjIxRDB1ZkpaalA3ZXc1VWM1Qm0yMDNPM1BoR0ZfVG9rZW46VEgxRGJrOGRZb3E3UHp4MUxZc2NBdVZObnVkXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>MPLS capable routers，被称为label-switched router</li>
</ol>
<p>forward packets to outgoing interface based <strong>only on label value</strong> (don’t inspect IP address)</p>
<p>MPLS forwarding table distinct from IP forwarding tables</p>
<ul>
<li>flexibility: MPLS forwarding decisions can differ from those of IP：<ul>
<li>use destination and source addresses to route flows to same destination differently (IP routing: path to destination determined by destination address alone)</li>
<li>re-route flows quickly if link fails: pre-computed backup paths</li>
</ul>
</li>
</ul>
<h2 id="6-6-data-center-networking"><a href="#6-6-data-center-networking" class="headerlink" title="6.6 data center networking"></a>6.6 data center networking</h2><h1 id="7-Wireless-and-Networks"><a href="#7-Wireless-and-Networks" class="headerlink" title="7 Wireless and Networks"></a>7 Wireless and Networks</h1><h2 id="7-1-introduction"><a href="#7-1-introduction" class="headerlink" title="7.1 introduction"></a>7.1 introduction</h2><ol>
<li>无线网络中的要素</li>
</ol>
<ul>
<li>Wireless hosts<ul>
<li>主机本身可能可以移动，也可能不移动（wireless does not always mean mobility!）</li>
</ul>
</li>
<li>Base station基站<ul>
<li>typically connected to wired network</li>
<li>relay中继 - responsible for sending packets between wired network and wireless host(s) in its “area”</li>
<li>e.g., cell towers, 802.11 access points</li>
</ul>
</li>
<li>wireless link<ul>
<li>两种主要特性：链路速率和覆盖区域</li>
</ul>
</li>
<li>infrastructure mode基础设施模式<ul>
<li>与基站关联的主机通常被称为以基础设施模式运行，因为所有传统的网络服务都由网络向通过基站相连的主机提供</li>
</ul>
</li>
<li>ad hoc mode自组织<ul>
<li>no base stations</li>
<li>nodes can only transmit to other nodes within link coverage</li>
<li>nodes organize themselves into a network: route among themselves</li>
</ul>
</li>
</ul>
<ol>
<li>无线网络的分类</li>
</ol>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=NzU2NTZkNDQ0YzBlMjI3ZGYwOTQ0ZWYwZWNlNDcxNDNfTzVJZkdqSmw1aFV4WGhoN0s3TWtPUWw3cThkMEEyS2JfVG9rZW46TDQ0RmJNRFhnb1ZrVUp4VTVrQmNCd2E5bkliXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<h2 id="7-2-Wireless-links-and-network-characteristics"><a href="#7-2-Wireless-links-and-network-characteristics" class="headerlink" title="7.2 Wireless links and network characteristics"></a>7.2 Wireless links and network characteristics</h2><ol>
<li>无线链路的特点：</li>
</ol>
<ul>
<li>fading (attenuation)递减的信号强度<ul>
<li>Wireless radio signal attenuates (loses power) as it propagates (free space “path loss”)</li>
<li>Free space path loss ~ (fd)^2</li>
</ul>
</li>
<li>multipath多路径传播<ul>
<li>multipath propagation多径传播: radio signal reflects off objects ground, built environment, arriving at destination at slightly different times</li>
</ul>
</li>
<li>noise来自其他源的干扰<ul>
<li>在同一个频段发送信号的电波源将互相干扰</li>
<li>SNR: signal-to-noise ratio 信噪比，单位是dB<ul>
<li>较大的SNR使接收方更容易从背景噪声中提取传输的信号</li>
<li>BER：比特差错率，是在接收方收到的有错传输比特的概率</li>
<li>given physical layer: increase power -&gt; increase SNR-&gt;decrease BER</li>
<li>SNR may change with mobility: dynamically adapt physical layer (modulation technique, rate)</li>
</ul>
</li>
</ul>
</li>
<li>hidden terminals隐藏终端问题</li>
</ul>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MGIwN2E0MjEzMDY3MzFlY2VjNTA2NWFlM2VkN2UyNWZfbmFjYW5ReEVnV0NaSUN4cEI4bUJRSzlMT3VMVnJXYVVfVG9rZW46VTVRbmJQemRXb01NdVZ4WGZSbWNSSVZRblNkXzE3MTg3MDkyNjY6MTcxODcxMjg2Nl9WNA" alt="img"></p>
<ol>
<li>CDMA 码分多址</li>
</ol>
<p>encoding: inner product: (original data) X (chipping sequence)</p>
<p>decoding: summed inner-product: (encoded data) X (chipping sequence)</p>
<h2 id="7-3-WiFi-802-11-wireless-LANs"><a href="#7-3-WiFi-802-11-wireless-LANs" class="headerlink" title="7.3 WiFi: 802.11 wireless LANs"></a>7.3 WiFi: 802.11 wireless LANs</h2><h3 id="7-3-1-802-11无线局域网体系结构"><a href="#7-3-1-802-11无线局域网体系结构" class="headerlink" title="7.3.1 802.11无线局域网体系结构"></a>7.3.1 802.11无线局域网体系结构</h3><ol>
<li>IEEE 802.11 Wireless LAN</li>
</ol>
<p>all use CSMA&#x2F;<strong>CA</strong> for multiple access, and have base-station and ad-hoc network versions</p>
<p>802.11 LAN architecture：</p>
<ul>
<li>802.11体系结构的基本构件模块是基本服务集BSS（Basic Service Set），BSS包含一个或多个无线站点以及一个被称为接入点AP的中央基站</li>
</ul>
<ol>
<li>802.11: Channels</li>
</ol>
<p>spectrum divided into channels at different frequencies</p>
<p>AP admin chooses frequency for AP</p>
<p>可能有干扰</p>
<ol>
<li>802.11: Association</li>
</ol>
<p>arriving host: must associate with an AP</p>
<ul>
<li>scans channels, listening for beacon frames containing AP’s name (SSID) and MAC address</li>
<li>selects AP to associate with</li>
<li>then may perform authentication [Chapter 8]</li>
<li>then typically run DHCP to get IP address in AP’s subnet</li>
</ul>
<ol>
<li>802.11: passive&#x2F;active scanning</li>
</ol>
<p>选择AP的方式，一个是接收AP的信标帧，一个是向所有的AP广播探测帧</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZDdmMjIzMDRhNDdmMTdiOWRhYjAzN2M0YTkyYzc2M2ZfU1NJdkc0VlA2cW15bUdZVFE4MnRUelFjZ2JkeklldE9fVG9rZW46V3NSaWJEdHRVb1dpNVl4aW9TTGNjZUZabmpkXzE3MTg3MDkyNjc6MTcxODcxMjg2N19WNA" alt="img"></p>
<h3 id="7-3-2-802-11MAC协议"><a href="#7-3-2-802-11MAC协议" class="headerlink" title="7.3.2 802.11MAC协议"></a>7.3.2 802.11MAC协议</h3><ol>
<li>IEEE 802.11 MAC Protocol: CSMA&#x2F;CA</li>
</ol>
<p><strong>802.11使用碰撞避免技术而非碰撞检测；使用链路层确认&#x2F;重传（ARQ）方案</strong></p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZTFlODA3N2UxNzZiMGFhMzRiNThkZjM2NDM1MDc4MmVfRmxST054Vmd1ZGRZNnZpOGZ3VmtvSVVvMTZldUJjeGFfVG9rZW46UFo3aGJJWUtHb1dzOU54a2N0UGNtaEdYbkpnXzE3MTg3MDkyNjc6MTcxODcxMjg2N19WNA" alt="img"></p>
<ol>
<li>处理隐藏终端：RTS和CTS</li>
</ol>
<ul>
<li>RTS：Request to Send，短请求发送</li>
<li>CTS：Clear to Send，允许发送</li>
</ul>
<p>过程：</p>
<ul>
<li>sender first transmits small RTS packet to BS using CSMA<ul>
<li><strong>RTSs may still collide with each other (but they’re short)</strong></li>
</ul>
</li>
<li>BS <strong>broadcasts</strong> CTS in response to RTS</li>
<li>CTS heard by all nodes<ul>
<li>sender transmits data frame</li>
<li>other stations defer transmissions</li>
</ul>
</li>
</ul>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=N2Y5ZTA0YjNjZTE5NzA4ZjBiMjYwYTYyOTUxMGJiZmNfRWdsOHRyVDZNZXlKM3A1cmJXZkFDQmU3YzFvOFptTFlfVG9rZW46SmFCamJvTGwzbzI1M3p4N3R0dGMwZktpbjgxXzE3MTg3MDkyNjc6MTcxODcxMjg2N19WNA" alt="img"></p>
<h3 id="7-3-3-802-11-frame-addressing"><a href="#7-3-3-802-11-frame-addressing" class="headerlink" title="7.3.3 802.11 frame: addressing"></a>7.3.3 802.11 frame: addressing</h3><p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MzUyYzdhZmNmNmI2OGI5NjlhOWJmZjBiNjk4YmVkYzdfeFB3cW0wcFc0aGpqS3JyM1U2TmljZkUzUHpsREQ5SUdfVG9rZW46QTUycGJiWjRQb1c3MUl4MFJBTWNrbjdBbjRiXzE3MTg3MDkyNjc6MTcxODcxMjg2N19WNA" alt="img"></p>
<p>802.11 WiFi frame: </p>
<p>address1: AP, address2: H1, address3: R1(router)</p>
<p>802.3 Ethernet frame:</p>
<p>dest, src</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=MGM4ZmY4ZDA5YzNhZDRkNDg5ZDE4NjkxZWY3N2FkMDRfcjNDbHZPQ0hMcE94aUZ2cWVtUzNXZHVqdnNhTXRUTmZfVG9rZW46VVhQa2JyMERRbzFPeTl4YmhrYmNUNVBUbmdnXzE3MTg3MDkyNjc6MTcxODcxMjg2N19WNA" alt="img"></p>
<h3 id="7-3-4-802-11-mobility-within-same-subnet"><a href="#7-3-4-802-11-mobility-within-same-subnet" class="headerlink" title="7.3.4 802.11: mobility within same subnet"></a>7.3.4 802.11: mobility within same subnet</h3><p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=OWM4OWI3ZjFjOGYzOGE5NGVlZjY1OGY0MGU0NzEyMTJfY1F0eTVIZHF0eWV2bG5iTTl5N2JoTXIzVnFYYk5pMGVfVG9rZW46RWluc2JEbmJGb3B2eUp4R29DRGNtV2p6bmJoXzE3MTg3MDkyNjc6MTcxODcxMjg2N19WNA" alt="img"></p>
<h3 id="7-3-5-802-11-advanced-capabilities"><a href="#7-3-5-802-11-advanced-capabilities" class="headerlink" title="7.3.5 802.11: advanced capabilities"></a>7.3.5 802.11: advanced capabilities</h3><ol>
<li>速率适应Rate adaptation</li>
</ol>
<p>SNR decreases, BER increase as node moves away from base station</p>
<p>When BER becomes too high, switch to lower transmission rate but with lower BER</p>
<ol>
<li>功率管理power management</li>
</ol>
<ul>
<li>node-to-AP: “I am going to sleep until next beacon frame”<ul>
<li>AP knows not to transmit frames to this node</li>
<li>node wakes up before next beacon frame</li>
</ul>
</li>
<li>beacon frame: contains list of mobiles with AP-to-mobile frames waiting to be sent<ul>
<li>node will stay awake if AP-to-mobile frames to be sent; otherwise sleep again until next beacon frame</li>
</ul>
</li>
</ul>
<h3 id="7-3-6-Bluetooth"><a href="#7-3-6-Bluetooth" class="headerlink" title="7.3.6 Bluetooth"></a>7.3.6 Bluetooth</h3><p>Personal area networks: Bluetooth</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=N2EyODFhMTk1MjkxYWI2YjIzZGIwMWIyODY3YTgwYTdfbmh5eWVVbTJWRTJ6aTU2N1Jod2JqYzRWZHh1Wjhxb3pfVG9rZW46TnlKY2JxWjdNb1Iyd254cldISGNKY3c0blhiXzE3MTg3MDkyNjc6MTcxODcxMjg2N19WNA" alt="img"></p>
<h2 id="7-4-Cellular-networks-4G-and-5G"><a href="#7-4-Cellular-networks-4G-and-5G" class="headerlink" title="7.4 Cellular networks: 4G and 5G"></a>7.4 Cellular networks: 4G and 5G</h2><h3 id="7-4-1-Elements-of-4G-LTE-architecture"><a href="#7-4-1-Elements-of-4G-LTE-architecture" class="headerlink" title="7.4.1 Elements of 4G LTE architecture"></a>7.4.1 Elements of 4G LTE architecture</h3><ul>
<li>移动设备Mobile device</li>
<li>基站Base station</li>
<li>归属用户服务器Home Subscriber Service（HSS）<ul>
<li>控制平面部件，是一个数据库，储存关于移动设备的信息</li>
<li>works with MME in device authentication</li>
</ul>
</li>
<li>服务网关S-GW（Serving Gateway）、PDN网关P-GW（PDN Gateway）等其他网络路由器<ul>
<li>是位于移动设备与因特网之间的数据路径上的两台路由器</li>
<li>P-GW provides NAT services</li>
</ul>
</li>
<li>移动性管理实体MME（Mobility Management Entity）<ul>
<li>MME也是一个控制平面组件</li>
<li>device authentication (device-to-network, network- to-device) coordinated with mobile home network HSS</li>
<li>path (tunneling) setup from mobile device to P-GW</li>
<li>device handover between cells</li>
<li>tracking&#x2F;paging device location</li>
</ul>
</li>
</ul>
<h3 id="7-4-2-LTE-data-plane-control-plane-separation"><a href="#7-4-2-LTE-data-plane-control-plane-separation" class="headerlink" title="7.4.2 LTE: data plane control plane separation"></a>7.4.2 LTE: data plane control plane separation</h3><ol>
<li>LTE data plane protocol stack</li>
</ol>
<p>LTE将移动设备的链路层分为三个子层，从IP向下：</p>
<ul>
<li>分组数据汇聚Packet Data Convergence: header compression, encryption</li>
<li>无线链路控制Radio Link Control (RLC) Protocol: fragmentation&#x2F;reassembly, reliable data transfer</li>
<li>介质访问控制（MAC）Medium Access:requesting, use of radio transmission slots (OFDM)</li>
</ul>
<h3 id="7-4-3-Radio-Access-Network-4G-radio无线电接入网"><a href="#7-4-3-Radio-Access-Network-4G-radio无线电接入网" class="headerlink" title="7.4.3 Radio Access Network: 4G radio无线电接入网"></a>7.4.3 Radio Access Network: 4G radio无线电接入网</h3><p>LTE在下行信道上使用频分复用和时分复用的组合，称为正交频分复用OFDM（Orthogonal Frequency Division Multiplexing）</p>
<h3 id="7-4-4-LTE附加功能：网络连接和功率管理"><a href="#7-4-4-LTE附加功能：网络连接和功率管理" class="headerlink" title="7.4.4 LTE附加功能：网络连接和功率管理"></a>7.4.4 LTE附加功能：网络连接和功率管理</h3><ol>
<li>网络连接</li>
</ol>
<p>见p377</p>
<p><img src="https://ur2x4vqise.feishu.cn/space/api/box/stream/download/asynccode/?code=ZjY4Y2U3YmUwMTM3ZDdlN2QyNTcyNWE5ZWEwNmFmMDhfclJoM2lVVEJ0YlV5Z3hHSnJGSVFtNnhZM25FMHUwRFdfVG9rZW46SHBzY2JSOVNsb3dRVHN4T0JUQWMwUUNobkFlXzE3MTg3MDkyNjc6MTcxODcxMjg2N19WNA" alt="img"></p>
<ol>
<li>功率管理</li>
</ol>
<p>as in WiFi, Bluetooth: LTE mobile may put radio to “sleep” to conserve battery:</p>
<ul>
<li>light sleep: after 100’s msec of inactivity<ul>
<li>wake up periodically (100’s msec) to check for downstream transmissions</li>
</ul>
</li>
<li>deep sleep: after 5-10 secs of inactivity<ul>
<li>mobile may change cells while deep sleeping – need to re-establish association</li>
</ul>
</li>
</ul>
<h3 id="7-4-5-Global-cellular-network-a-network-of-IP-networks"><a href="#7-4-5-Global-cellular-network-a-network-of-IP-networks" class="headerlink" title="7.4.5 Global cellular network: a network of IP networks"></a>7.4.5 Global cellular network: a network of IP networks</h3><h3 id="7-4-6-5G-cellular-network"><a href="#7-4-6-5G-cellular-network" class="headerlink" title="7.4.6 5G cellular network"></a>7.4.6 5G cellular network</h3><ol>
<li>5G由三个共存的标准组成：</li>
</ol>
<ul>
<li>eMBB（增强型移动带宽）</li>
<li>URLLC（极可靠低时延通信）</li>
<li>mMTC（大规模及其类型通信）</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://liuydd.github.io">Sheeta Liu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://liuydd.github.io/2024/06/17/networks/">http://liuydd.github.io/2024/06/17/networks/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://liuydd.github.io" target="_blank">等到天亮我们都寻找到最漂亮的愿望</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="../../../../tags/notes/">notes</a></div><div class="post_share"><div class="social-share" data-image="../../../../images/cover39.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="../../22/digitallogic/"><img class="prev-cover" src="../../../../images/cover40.jpg" onerror="onerror=null;src='../../../../img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">《数字逻辑电路》期末复习</div></div></a></div><div class="next-post pull-right"><a href="../../../02/27/moyu7/"><img class="next-cover" src="../../../../images/cover38.jpg" onerror="onerror=null;src='../../../../img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Sheetaの摸鱼日记（七）</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="../../../12/27/jiwangan/" title="《计算机网络安全与技术》期末复习"><img class="cover" src="../../../.././images/cover44.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-27</div><div class="title">《计算机网络安全与技术》期末复习</div></div></a></div><div><a href="../../../12/27/shulun/" title="《初等数论》期末复习"><img class="cover" src="../../../.././images/cover43.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-27</div><div class="title">《初等数论》期末复习</div></div></a></div><div><a href="../../22/iai/" title="《人工智能导论》期末复习"><img class="cover" src="../../../../images/cover41.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-22</div><div class="title">《人工智能导论》期末复习</div></div></a></div><div><a href="../../22/digitallogic/" title="《数字逻辑电路》期末复习"><img class="cover" src="../../../../images/cover40.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-22</div><div class="title">《数字逻辑电路》期末复习</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="../img/touxiang2.jpg" onerror="this.onerror=null;this.src='../img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Sheeta Liu</div><div class="author-info__description">生活不需要意义，吃点好的，我也爱你</div></div><div class="card-info-data site-data is-center"><a href="../archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="../tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/liuydd"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">众生皆苦，唯有自渡...</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ReadMe"><span class="toc-number">1.</span> <span class="toc-text">ReadMe</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Computer-Networks-and-the-Internet"><span class="toc-number"></span> <span class="toc-text">1 Computer Networks and the Internet</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-What-is-the-Internet"><span class="toc-number">1.</span> <span class="toc-text">1.1 What is the Internet?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-Network-edge%E7%BD%91%E7%BB%9C%E8%BE%B9%E7%BC%98"><span class="toc-number">2.</span> <span class="toc-text">1.2 Network edge网络边缘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-Network-core%E7%BD%91%E7%BB%9C%E6%A0%B8%E5%BF%83"><span class="toc-number">3.</span> <span class="toc-text">1.3 Network core网络核心</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-Performance-loss%E4%B8%A2%E5%8C%85-delay%E6%97%B6%E5%BB%B6-throughput%E5%90%9E%E5%90%90%E9%87%8F"><span class="toc-number">4.</span> <span class="toc-text">1.4 Performance: loss丢包, delay时延, throughput吞吐量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5-Protocol-layers-service-models%E5%8D%8F%E8%AE%AE%E5%B1%82%E6%AC%A1%E5%8F%8A%E5%85%B6%E6%9C%8D%E5%8A%A1%E6%A8%A1%E5%9E%8B"><span class="toc-number">5.</span> <span class="toc-text">1.5 Protocol layers, service models协议层次及其服务模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-6-Security"><span class="toc-number">6.</span> <span class="toc-text">1.6 Security</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-The-Application-Layer"><span class="toc-number"></span> <span class="toc-text">2 The Application Layer</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-Principles-of-network-applications"><span class="toc-number">1.</span> <span class="toc-text">2.1 Principles of network applications</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-Web-and-HTTP"><span class="toc-number">2.</span> <span class="toc-text">2.2 Web and HTTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-E-mail-SMTP-IMAP"><span class="toc-number">3.</span> <span class="toc-text">2.3 E-mail, SMTP, IMAP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-The-Domain-Name-System-DNS"><span class="toc-number">4.</span> <span class="toc-text">2.4 The Domain Name System DNS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-P2P-applications"><span class="toc-number">5.</span> <span class="toc-text">2.5 P2P applications</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-video-streaming-and-content-distribution-networks"><span class="toc-number">6.</span> <span class="toc-text">2.6 video streaming and content distribution networks</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-The-Transport-Layer"><span class="toc-number"></span> <span class="toc-text">3 The Transport Layer</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-Transport-layer-services"><span class="toc-number">1.</span> <span class="toc-text">3.1 Transport-layer services</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-Multiplexing-and-demultiplexing%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8%E4%B8%8E%E5%A4%9A%E8%B7%AF%E5%88%86%E8%A7%A3"><span class="toc-number">2.</span> <span class="toc-text">3.2 Multiplexing and demultiplexing多路复用与多路分解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-Connectionless-transport-UDP"><span class="toc-number">3.</span> <span class="toc-text">3.3 Connectionless transport: UDP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-Principles-of-reliable-data-transfer"><span class="toc-number">4.</span> <span class="toc-text">3.4 Principles of reliable data transfer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-5-Connection-oriented-transport-TCP"><span class="toc-number">5.</span> <span class="toc-text">3.5 Connection-oriented transport: TCP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-6-Principles-of-congestion-control"><span class="toc-number">6.</span> <span class="toc-text">3.6 Principles of congestion control</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-7-TCP-congestion-control"><span class="toc-number">7.</span> <span class="toc-text">3.7 TCP congestion control</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-8-Evolution-of-transport-layer-functionality%E8%BF%90%E8%BE%93%E5%B1%82%E5%8A%9F%E8%83%BD%E7%9A%84%E6%BC%94%E5%8C%96"><span class="toc-number">8.</span> <span class="toc-text">3.8 Evolution of transport-layer functionality运输层功能的演化</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-The-Network-Layer-the-Data-Plane"><span class="toc-number"></span> <span class="toc-text">4 The Network Layer: the Data Plane</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-Network-layer-overview"><span class="toc-number">1.</span> <span class="toc-text">4.1 Network layer: overview</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-What%E2%80%99s-inside-a-router"><span class="toc-number">2.</span> <span class="toc-text">4.2 What’s inside a router</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-IP-the-Internet-Protocol"><span class="toc-number">3.</span> <span class="toc-text">4.3 IP: the Internet Protocol</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4Generalized-Forwarding%E6%B3%9B%E5%8C%96%E8%BD%AC%E5%8F%91-SDN"><span class="toc-number">4.</span> <span class="toc-text">4.4Generalized Forwarding泛化转发, SDN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5-Middleboxes%EF%BC%88%E9%98%B2%E7%81%AB%E5%A2%99"><span class="toc-number">5.</span> <span class="toc-text">4.5 Middleboxes（防火墙</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-The-Network-Layer-the-Control-Plane"><span class="toc-number"></span> <span class="toc-text">5 The Network Layer: the Control Plane</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-introduction"><span class="toc-number">1.</span> <span class="toc-text">5.1 introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-routing-protocols"><span class="toc-number">2.</span> <span class="toc-text">5.2 routing protocols</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-intra-ISP-routing-OSPF"><span class="toc-number">3.</span> <span class="toc-text">5.3 intra-ISP routing: OSPF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-routing-among-ISPs-BGP"><span class="toc-number">4.</span> <span class="toc-text">5.4 routing among ISPs: BGP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-5-SDN-control-plane"><span class="toc-number">5.</span> <span class="toc-text">5.5 SDN control plane</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-6-Internet-Control-Message-Protocol"><span class="toc-number">6.</span> <span class="toc-text">5.6 Internet Control Message Protocol</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-The-Link-Layer"><span class="toc-number"></span> <span class="toc-text">6 The Link Layer</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-introduction"><span class="toc-number">1.</span> <span class="toc-text">6.1 introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-error-detection-correction"><span class="toc-number">2.</span> <span class="toc-text">6.2 error detection, correction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-multiple-access-protocols%E5%A4%9A%E8%B7%AF%E8%AE%BF%E9%97%AE%E9%93%BE%E8%B7%AF%E5%92%8C%E5%8D%8F%E8%AE%AE"><span class="toc-number">3.</span> <span class="toc-text">6.3 multiple access protocols多路访问链路和协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4-LANs"><span class="toc-number">4.</span> <span class="toc-text">6.4 LANs</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-1-addressing-ARP"><span class="toc-number">4.1.</span> <span class="toc-text">6.4.1 addressing, ARP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-2-Erthernet"><span class="toc-number">4.2.</span> <span class="toc-text">6.4.2 Erthernet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-3-switches"><span class="toc-number">4.3.</span> <span class="toc-text">6.4.3 switches</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-4-VLANs"><span class="toc-number">4.4.</span> <span class="toc-text">6.4.4 VLANs</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-5-link-virtualization-MPLS"><span class="toc-number">5.</span> <span class="toc-text">6.5 link virtualization: MPLS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-6-data-center-networking"><span class="toc-number">6.</span> <span class="toc-text">6.6 data center networking</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-Wireless-and-Networks"><span class="toc-number"></span> <span class="toc-text">7 Wireless and Networks</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-introduction"><span class="toc-number">1.</span> <span class="toc-text">7.1 introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-Wireless-links-and-network-characteristics"><span class="toc-number">2.</span> <span class="toc-text">7.2 Wireless links and network characteristics</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3-WiFi-802-11-wireless-LANs"><span class="toc-number">3.</span> <span class="toc-text">7.3 WiFi: 802.11 wireless LANs</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-1-802-11%E6%97%A0%E7%BA%BF%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-number">3.1.</span> <span class="toc-text">7.3.1 802.11无线局域网体系结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-2-802-11MAC%E5%8D%8F%E8%AE%AE"><span class="toc-number">3.2.</span> <span class="toc-text">7.3.2 802.11MAC协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-3-802-11-frame-addressing"><span class="toc-number">3.3.</span> <span class="toc-text">7.3.3 802.11 frame: addressing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-4-802-11-mobility-within-same-subnet"><span class="toc-number">3.4.</span> <span class="toc-text">7.3.4 802.11: mobility within same subnet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-5-802-11-advanced-capabilities"><span class="toc-number">3.5.</span> <span class="toc-text">7.3.5 802.11: advanced capabilities</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-6-Bluetooth"><span class="toc-number">3.6.</span> <span class="toc-text">7.3.6 Bluetooth</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-4-Cellular-networks-4G-and-5G"><span class="toc-number">4.</span> <span class="toc-text">7.4 Cellular networks: 4G and 5G</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-1-Elements-of-4G-LTE-architecture"><span class="toc-number">4.1.</span> <span class="toc-text">7.4.1 Elements of 4G LTE architecture</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-2-LTE-data-plane-control-plane-separation"><span class="toc-number">4.2.</span> <span class="toc-text">7.4.2 LTE: data plane control plane separation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-3-Radio-Access-Network-4G-radio%E6%97%A0%E7%BA%BF%E7%94%B5%E6%8E%A5%E5%85%A5%E7%BD%91"><span class="toc-number">4.3.</span> <span class="toc-text">7.4.3 Radio Access Network: 4G radio无线电接入网</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-4-LTE%E9%99%84%E5%8A%A0%E5%8A%9F%E8%83%BD%EF%BC%9A%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E5%92%8C%E5%8A%9F%E7%8E%87%E7%AE%A1%E7%90%86"><span class="toc-number">4.4.</span> <span class="toc-text">7.4.4 LTE附加功能：网络连接和功率管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-5-Global-cellular-network-a-network-of-IP-networks"><span class="toc-number">4.5.</span> <span class="toc-text">7.4.5 Global cellular network: a network of IP networks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-6-5G-cellular-network"><span class="toc-number">4.6.</span> <span class="toc-text">7.4.6 5G cellular network</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="../2024/12/27/jiwangan/" title="《计算机网络安全与技术》期末复习"><img src=".././images/cover44.jpg" onerror="this.onerror=null;this.src='../img/404.jpg'" alt="《计算机网络安全与技术》期末复习"/></a><div class="content"><a class="title" href="../2024/12/27/jiwangan/" title="《计算机网络安全与技术》期末复习">《计算机网络安全与技术》期末复习</a><time datetime="2024-12-27T13:25:43.000Z" title="发表于 2024-12-27 21:25:43">2024-12-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="../2024/12/27/shulun/" title="《初等数论》期末复习"><img src=".././images/cover43.jpg" onerror="this.onerror=null;this.src='../img/404.jpg'" alt="《初等数论》期末复习"/></a><div class="content"><a class="title" href="../2024/12/27/shulun/" title="《初等数论》期末复习">《初等数论》期末复习</a><time datetime="2024-12-27T13:25:27.000Z" title="发表于 2024-12-27 21:25:27">2024-12-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="../2024/06/22/iai/" title="《人工智能导论》期末复习"><img src="../images/cover41.jpg" onerror="this.onerror=null;this.src='../img/404.jpg'" alt="《人工智能导论》期末复习"/></a><div class="content"><a class="title" href="../2024/06/22/iai/" title="《人工智能导论》期末复习">《人工智能导论》期末复习</a><time datetime="2024-06-22T14:25:02.000Z" title="发表于 2024-06-22 22:25:02">2024-06-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="../2024/06/22/digitallogic/" title="《数字逻辑电路》期末复习"><img src="../images/cover40.jpg" onerror="this.onerror=null;this.src='../img/404.jpg'" alt="《数字逻辑电路》期末复习"/></a><div class="content"><a class="title" href="../2024/06/22/digitallogic/" title="《数字逻辑电路》期末复习">《数字逻辑电路》期末复习</a><time datetime="2024-06-22T14:24:52.000Z" title="发表于 2024-06-22 22:24:52">2024-06-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="../2024/06/17/networks/" title="《计算机网络原理》期末复习"><img src="../images/cover39.jpg" onerror="this.onerror=null;this.src='../img/404.jpg'" alt="《计算机网络原理》期末复习"/></a><div class="content"><a class="title" href="../2024/06/17/networks/" title="《计算机网络原理》期末复习">《计算机网络原理》期末复习</a><time datetime="2024-06-17T09:27:23.000Z" title="发表于 2024-06-17 17:27:23">2024-06-17</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By Sheeta Liu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div><canvas class="fireworks" style="position: fixed; left: 0; top: 0; z-index: 1; pointer-events: none;" ></canvas>
<script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script>
<script type="text/javascript" src="/js/fireworks.js"></script>
<% } %></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="../../../../js/utils.js"></script><script src="../../../../js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="../../../../js/search/local-search.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo-lake-alpha-67.vercel.app',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-lake-alpha-67.vercel.app',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"superSample":2,"position":"left","width":150,"height":300,"hOffset":20,"vOffset":-90},"mobile":{"show":false,"scale":1},"react":{"opacityDefault":0.3,"opacityOnHover":0.3,"opacity":0.95},"log":false});</script></body></html>